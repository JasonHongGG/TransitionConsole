{
  "system": "ActivityManagementPlatform",
  "version": "1.0",
  "generatedAt": "2026-02-19T00:00:00.000Z",
  "inputs": {
    "specPath": "StateTranstionDiagram/spec.md",
    "transitionPath": "StateTranstionDiagram/transition.md"
  },
  "spec": {
    "raw": null,
    "summary": {
      "productName": "社團活動管理平台",
      "goals": [
        "使用者清楚掌握活動資訊、報名狀態與剩餘名額。",
        "管理員能快速建立活動、掌握即時報名狀況。",
        "在高併發報名時仍能維持名額一致性，避免超賣與重複報名。"
      ],
      "roles": [
        {"id": "guest", "label": "Guest"},
        {"id": "member", "label": "Member"},
        {"id": "admin", "label": "Admin"}
      ]
    }
  },
  "diagrams": [
    {
      "id": "page_entry",
      "name": "Entry",
      "level": "page",
      "parentDiagramId": null,
      "roles": [],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "① Entry State Machine", "order": 1},
      "groups": [],
      "states": [
        {
          "id": "page.Entry.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_entry",
            "synthetic": false,
            "source": {"scope": "root", "raw": "Entry.Init"}
          }
        }
      ],
      "transitions": [],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_activitylistpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_activitylistpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 ActivityListPage",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_activitydetailpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 ActivityDetailPage",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_authpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_authpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AuthPage",
            "taskDescription": "建立 parent/child 關聯，表示 AuthPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_myactivitiespage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_myactivitiespage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 MyActivitiesPage",
            "taskDescription": "建立 parent/child 關聯，表示 MyActivitiesPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_adminactivitylistpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminActivityListPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminActivityListPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_adminactivityeditorpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminActivityEditorPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminActivityEditorPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.contains.page_adminregistrationspage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminregistrationspage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminRegistrationsPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminRegistrationsPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.invokes.page_activitylistpage.s.page_Entry_Init.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_entry", "stateId": "page.Entry.Init"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "以 Guest 繼續並進入活動列表",
            "taskDescription": "在 Entry.Init 觸發 continueAsGuest 導航到 /activities，並成功進入 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_entry.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 導向活動列表；API 取得活動清單只回傳公開狀態（published/full）且不需登入",
              "expected": null
            }
          ],
          "meta": {
            "reason": "continueAsGuest | navigate /activities",
            "action": "continueAsGuest",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.page_entry.invokes.page_authpage.s.page_Entry_Init.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_entry", "stateId": "page.Entry.Init"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "前往身分取得頁",
            "taskDescription": "在 Entry.Init 觸發 chooseAuth 導航到 /auth，並成功進入 AuthPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_entry.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 導向身分取得頁；若帶 returnTo 參數需保留，供成功後返回目標頁",
              "expected": null
            }
          ],
          "meta": {
            "reason": "chooseAuth | navigate /auth",
            "action": "chooseAuth",
            "navigateTarget": "/auth"
          }
        }
      ],
      "meta": {
        "pageName": "Entry",
        "featureName": null,
        "entryStateId": "page.Entry.Init",
        "entryValidations": [
          {
            "id": "v.page_entry.entry.01",
            "type": "semantic-check",
            "description": "UI 顯示公開入口（可繼續以 Guest 瀏覽、或前往登入/註冊）；導覽列不出現「我的活動/管理後台/登出」",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitylistpage",
      "name": "ActivityListPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": [],
      "variant": {
        "kind": "base",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {
          "guest": "page_activitylistpage_guest",
          "member": "page_activitylistpage_member",
          "admin": "page_activitylistpage_admin"
        },
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "② ActivityListPage Page", "order": 2},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityListPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_activitylistpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.Init"}
          }
        },
        {
          "id": "page.ActivityListPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_activitylistpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitylistpage.0001",
          "from": "page.ActivityListPage.Init",
          "to": "page.ActivityListPage.Ready",
          "event": "loadPublicActivities",
          "roles": [],
          "narrative": {
            "summary": "載入公開活動清單",
            "taskDescription": "在 ActivityListPage.Init 觸發 loadPublicActivities 取得清單並完成渲染，成功後進入 ActivityListPage.Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_activitylistpage.0001.01",
              "type": "semantic-check",
              "description": "API 回傳活動清單僅包含 status=published/full；UI 顯示每筆活動名稱/日期/地點/已報名人數/名額上限",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadPublicActivities"},
          "meta": {
            "diagramId": "page_activitylistpage",
            "source": {"raw": "ActivityListPage.Init --> ActivityListPage.Ready : loadPublicActivities"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_activitylistpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_activitylistpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 ActivityListPage",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_guest",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_guest", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Guest 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Guest 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_member",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_member", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Member 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Member 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_admin",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_admin", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Admin 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Admin 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitydetailpage.s.page_ActivityListPage_Ready.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "由列表進入活動詳情",
            "taskDescription": "在 ActivityListPage.Ready 點擊活動項目（clickActivityItem）導航到 /activities/:activityId，並進入 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 導向活動詳情頁並帶入 activityId；導覽列維持與當前身分一致（Guest 不顯示我的活動/管理後台）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickActivityItem | navigate /activities/:activityId",
            "action": "clickActivityItem",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_guest.s.page_ActivityListPage_Ready.to.page_ActivityListPage_guest_GuestInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_guest", "stateId": "page.ActivityListPage.guest.GuestInit"},
          "narrative": {
            "summary": "切換為 Guest 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyGuestView，導向 ActivityListPage.Guest 差異視角並進入 GuestInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_guest.01",
              "type": "semantic-check",
              "description": "UI 以 Guest 視角渲染導覽；Header 只顯示「活動列表、登入/註冊」，不出現「我的活動/管理後台/登出」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyGuestView | navigate ActivityListPage.Guest",
            "action": "applyGuestView",
            "navigateTarget": "ActivityListPage.Guest"
          }
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_member.s.page_ActivityListPage_Ready.to.page_ActivityListPage_member_MemberInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberInit"},
          "narrative": {
            "summary": "切換為 Member 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyMemberView，導向 ActivityListPage.Member 差異視角並進入 MemberInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_member.01",
              "type": "semantic-check",
              "description": "UI 以 Member 視角渲染差異操作（顯示報名/取消相關入口）；Header 顯示「我的活動、登出」，不顯示「登入/註冊」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyMemberView | navigate ActivityListPage.Member",
            "action": "applyMemberView",
            "navigateTarget": "ActivityListPage.Member"
          }
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_admin.s.page_ActivityListPage_Ready.to.page_ActivityListPage_admin_AdminInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminInit"},
          "narrative": {
            "summary": "切換為 Admin 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyAdminView，導向 ActivityListPage.Admin 差異視角並進入 AdminInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_admin.01",
              "type": "semantic-check",
              "description": "UI 以 Admin 視角渲染導覽；Header 顯示「我的活動、管理後台、登出」且不顯示「登入/註冊」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyAdminView | navigate ActivityListPage.Admin",
            "action": "applyAdminView",
            "navigateTarget": "ActivityListPage.Admin"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityListPage",
        "featureName": null,
        "entryStateId": "page.ActivityListPage.Init",
        "entryValidations": [
          {
            "id": "v.page_activitylistpage.entry.01",
            "type": "semantic-check",
            "description": "UI 進入活動列表頁；頁面顯示 loading 狀態直到清單回應",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitylistpage_guest",
      "name": "ActivityListPage.Guest",
      "level": "page",
      "parentDiagramId": "page_activitylistpage",
      "roles": ["guest"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitylistpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["guest"]
      },
      "source": {"type": "mermaid", "sectionTitle": "③ ActivityListPage.Guest（Guest 視角）", "order": 3},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityListPage.guest.GuestInit",
          "label": "GuestInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "guest"],
          "meta": {
            "diagramId": "page_activitylistpage_guest",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.GuestInit"}
          }
        },
        {
          "id": "page.ActivityListPage.guest.GuestReady",
          "label": "GuestReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "guest"],
          "meta": {
            "diagramId": "page_activitylistpage_guest",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.GuestReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitylistpage_guest.0001",
          "from": "page.ActivityListPage.guest.GuestInit",
          "to": "page.ActivityListPage.guest.GuestReady",
          "event": "renderGuestActions",
          "roles": ["guest"],
          "narrative": {
            "summary": "渲染 Guest 可用入口",
            "taskDescription": "在 GuestInit 觸發 renderGuestActions 呈現登入/註冊入口，完成後進入 GuestReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitylistpage_guest.0001.01",
              "type": "semantic-check",
              "description": "UI 顯示登入/註冊入口；清單項目不提供可完成報名/取消的 CTA",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderGuestActions"},
          "meta": {
            "diagramId": "page_activitylistpage_guest",
            "source": {"raw": "ActivityListPage.GuestInit --> ActivityListPage.GuestReady : renderGuestActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_guest",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_guest", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Guest 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Guest 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_guest.s.page_ActivityListPage_Ready.to.page_ActivityListPage_guest_GuestInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_guest", "stateId": "page.ActivityListPage.guest.GuestInit"},
          "narrative": {
            "summary": "切換為 Guest 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyGuestView，導向 ActivityListPage.Guest 差異視角並進入 GuestInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_guest.01",
              "type": "semantic-check",
              "description": "UI 以 Guest 視角渲染導覽；Header 只顯示「活動列表、登入/註冊」，不出現「我的活動/管理後台/登出」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyGuestView | navigate ActivityListPage.Guest",
            "action": "applyGuestView",
            "navigateTarget": "ActivityListPage.Guest"
          }
        },
        {
          "id": "c.page_activitylistpage_guest.invokes.page_authpage.s.page_ActivityListPage_guest_GuestReady.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_guest", "stateId": "page.ActivityListPage.guest.GuestReady"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "從列表 Guest 視角前往登入/註冊",
            "taskDescription": "在 GuestReady 點擊登入/註冊（clickLoginOrRegister）導航到 /auth，並進入 AuthPage.Init（需保留 returnTo=/activities）。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_guest.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 導向 /auth 並保留 returnTo=/activities；成功登入後需回到活動列表",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLoginOrRegister | navigate /auth",
            "action": "clickLoginOrRegister",
            "navigateTarget": "/auth"
          }
        },
        {
          "id": "c.page_activitylistpage_guest.invokes.page_activitylistpage.s.page_ActivityListPage_guest_GuestReady.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_guest", "stateId": "page.ActivityListPage.guest.GuestReady"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "從 Guest 差異視角返回 Base",
            "taskDescription": "在 GuestReady 觸發 returnToBase 導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_guest.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回 base 入口；仍維持 Guest Header 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities",
            "action": "returnToBase",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityListPage",
        "featureName": null,
        "entryStateId": "page.ActivityListPage.guest.GuestInit",
        "entryValidations": [
          {
            "id": "v.page_activitylistpage_guest.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Guest 差異視角；不得出現「我的活動/管理後台/登出」入口",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitylistpage_member",
      "name": "ActivityListPage.Member",
      "level": "page",
      "parentDiagramId": "page_activitylistpage",
      "roles": ["member"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitylistpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member"]
      },
      "source": {"type": "mermaid", "sectionTitle": "④ ActivityListPage.Member（Member 視角）", "order": 4},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityListPage.member.MemberInit",
          "label": "MemberInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "member"],
          "meta": {
            "diagramId": "page_activitylistpage_member",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.MemberInit"}
          }
        },
        {
          "id": "page.ActivityListPage.member.MemberReady",
          "label": "MemberReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "member"],
          "meta": {
            "diagramId": "page_activitylistpage_member",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.MemberReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitylistpage_member.0001",
          "from": "page.ActivityListPage.member.MemberInit",
          "to": "page.ActivityListPage.member.MemberReady",
          "event": "renderMemberActions",
          "roles": ["member"],
          "narrative": {
            "summary": "渲染 Member 可用操作",
            "taskDescription": "在 MemberInit 觸發 renderMemberActions 呈現 Member 相關入口與狀態，完成後進入 MemberReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitylistpage_member.0001.01",
              "type": "semantic-check",
              "description": "UI 顯示 Member 可用操作；對每個活動正確顯示報名狀態（已報名/未報名）與是否額滿",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderMemberActions"},
          "meta": {
            "diagramId": "page_activitylistpage_member",
            "source": {"raw": "ActivityListPage.MemberInit --> ActivityListPage.MemberReady : renderMemberActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_member",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_member", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Member 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Member 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_member.s.page_ActivityListPage_Ready.to.page_ActivityListPage_member_MemberInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberInit"},
          "narrative": {
            "summary": "切換為 Member 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyMemberView，導向 ActivityListPage.Member 差異視角並進入 MemberInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_member.01",
              "type": "semantic-check",
              "description": "UI 以 Member 視角渲染差異操作（顯示報名/取消相關入口）；Header 顯示「我的活動、登出」，不顯示「登入/註冊」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyMemberView | navigate ActivityListPage.Member",
            "action": "applyMemberView",
            "navigateTarget": "ActivityListPage.Member"
          }
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_registeractivityfeature.s.page_ActivityListPage_member_MemberReady.to.feature_RegisterActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Init"},
          "narrative": {
            "summary": "從列表觸發報名功能",
            "taskDescription": "在 MemberReady 點擊報名（clickRegisterFromList）進入 RegisterActivityFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.feature_registeractivityfeature.01",
              "type": "semantic-check",
              "description": "UI 將「報名」按鈕設為 loading/disabled；送出後端請求必須具備防重複（例如 idempotency key 或等效機制）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickRegisterFromList | navigate RegisterActivityFeature",
            "action": "clickRegisterFromList",
            "navigateTarget": "RegisterActivityFeature"
          }
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_cancelregistrationfeature.s.page_ActivityListPage_member_MemberReady.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從列表觸發取消報名功能",
            "taskDescription": "在 MemberReady 點擊取消報名（clickCancelFromList）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.feature_cancelregistrationfeature.01",
              "type": "semantic-check",
              "description": "UI 將「取消報名」按鈕設為 loading/disabled；取消成功後名額與狀態需同步更新",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickCancelFromList | navigate CancelRegistrationFeature",
            "action": "clickCancelFromList",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.page_activitylistpage_member.invokes.page_myactivitiespage.s.page_ActivityListPage_member_MemberReady.to.page_MyActivitiesPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Init"},
          "narrative": {
            "summary": "前往我的活動頁",
            "taskDescription": "在 MemberReady 點擊我的活動（clickMyActivities）導航到 /my-activities，並進入 MyActivitiesPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.page_myactivitiespage.01",
              "type": "semantic-check",
              "description": "UI 導向我的活動；API 只回傳本使用者已報名且未取消的活動",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickMyActivities | navigate /my-activities",
            "action": "clickMyActivities",
            "navigateTarget": "/my-activities"
          }
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_logoutfeature.s.page_ActivityListPage_member_MemberReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "觸發登出功能",
            "taskDescription": "在 MemberReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "UI 呼叫登出；成功後回到 Guest 視角且 Header 不再顯示「我的活動/登出」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitylistpage_member.invokes.page_activitylistpage.s.page_ActivityListPage_member_MemberReady.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "從 Member 差異視角返回 Base",
            "taskDescription": "在 MemberReady 觸發 returnToBase 導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回 base 圖入口；清單仍可正常顯示，且 Member 身分下 Header/導覽仍維持 Member 可見規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities",
            "action": "returnToBase",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityListPage",
        "featureName": null,
        "entryStateId": "page.ActivityListPage.member.MemberInit",
        "entryValidations": [
          {
            "id": "v.page_activitylistpage_member.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Member 差異視角；同一清單項目可顯示「可報名/已報名/額滿」狀態",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitylistpage_admin",
      "name": "ActivityListPage.Admin",
      "level": "page",
      "parentDiagramId": "page_activitylistpage",
      "roles": ["admin"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitylistpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑤ ActivityListPage.Admin（Admin 視角）", "order": 5},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityListPage.admin.AdminInit",
          "label": "AdminInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_activitylistpage_admin",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.AdminInit"}
          }
        },
        {
          "id": "page.ActivityListPage.admin.AdminReady",
          "label": "AdminReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_activitylistpage_admin",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityListPage.AdminReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitylistpage_admin.0001",
          "from": "page.ActivityListPage.admin.AdminInit",
          "to": "page.ActivityListPage.admin.AdminReady",
          "event": "renderAdminActions",
          "roles": ["admin"],
          "narrative": {
            "summary": "渲染 Admin 可用入口",
            "taskDescription": "在 AdminInit 觸發 renderAdminActions 呈現「我的活動/管理後台/登出」入口，完成後進入 AdminReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitylistpage_admin.0001.01",
              "type": "semantic-check",
              "description": "UI 顯示「我的活動/管理後台/登出」入口；不顯示第二個重複登出入口",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderAdminActions"},
          "meta": {
            "diagramId": "page_activitylistpage_admin",
            "source": {"raw": "ActivityListPage.AdminInit --> ActivityListPage.AdminReady : renderAdminActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitylistpage.contains.page_activitylistpage_admin",
          "type": "contains",
          "from": {"diagramId": "page_activitylistpage", "stateId": null},
          "to": {"diagramId": "page_activitylistpage_admin", "stateId": null},
          "narrative": {
            "summary": "ActivityListPage 包含 Admin 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityListPage.Admin 是 ActivityListPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitylistpage_admin.s.page_ActivityListPage_Ready.to.page_ActivityListPage_admin_AdminInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminInit"},
          "narrative": {
            "summary": "切換為 Admin 視角",
            "taskDescription": "在 ActivityListPage.Ready 觸發 applyAdminView，導向 ActivityListPage.Admin 差異視角並進入 AdminInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitylistpage_admin.01",
              "type": "semantic-check",
              "description": "UI 以 Admin 視角渲染導覽；Header 顯示「我的活動、管理後台、登出」且不顯示「登入/註冊」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyAdminView | navigate ActivityListPage.Admin",
            "action": "applyAdminView",
            "navigateTarget": "ActivityListPage.Admin"
          }
        },
        {
          "id": "c.page_activitylistpage_admin.invokes.page_myactivitiespage.s.page_ActivityListPage_admin_AdminReady.to.page_MyActivitiesPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminReady"},
          "to": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Init"},
          "narrative": {
            "summary": "前往我的活動頁",
            "taskDescription": "在 AdminReady 點擊我的活動（clickMyActivities）導航到 /my-activities，並進入 MyActivitiesPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_admin.invokes.page_myactivitiespage.01",
              "type": "semantic-check",
              "description": "UI 導向我的活動；Header 仍維持 Admin 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickMyActivities | navigate /my-activities",
            "action": "clickMyActivities",
            "navigateTarget": "/my-activities"
          }
        },
        {
          "id": "c.page_activitylistpage_admin.invokes.page_adminactivitylistpage.s.page_ActivityListPage_admin_AdminReady.to.page_AdminActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminReady"},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"},
          "narrative": {
            "summary": "進入管理後台活動列表",
            "taskDescription": "在 AdminReady 點擊管理後台（clickAdminPanel）導航到 /admin/activities，並進入 AdminActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_admin.invokes.page_adminactivitylistpage.01",
              "type": "semantic-check",
              "description": "API/路由授權通過（Admin）；可進入管理活動列表",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickAdminPanel | navigate /admin/activities",
            "action": "clickAdminPanel",
            "navigateTarget": "/admin/activities"
          }
        },
        {
          "id": "c.page_activitylistpage_admin.invokes.feature_logoutfeature.s.page_ActivityListPage_admin_AdminReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "觸發登出功能",
            "taskDescription": "在 AdminReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_admin.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；Header 不再顯示管理後台入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitylistpage_admin.invokes.page_activitylistpage.s.page_ActivityListPage_admin_AdminReady.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminReady"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "從 Admin 差異視角返回 Base",
            "taskDescription": "在 AdminReady 觸發 returnToBase 導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_admin.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回 base 入口；仍維持 Admin Header 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities",
            "action": "returnToBase",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityListPage",
        "featureName": null,
        "entryStateId": "page.ActivityListPage.admin.AdminInit",
        "entryValidations": [
          {
            "id": "v.page_activitylistpage_admin.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Admin 差異視角；Header 顯示管理後台入口且不顯示登入/註冊",
            "expected": null
          }
        ]
      }
    }
    ,
    {
      "id": "page_activitydetailpage",
      "name": "ActivityDetailPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": [],
      "variant": {
        "kind": "base",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {
          "guest": "page_activitydetailpage_guest",
          "member": "page_activitydetailpage_member",
          "admin": "page_activitydetailpage_admin"
        },
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "⑥ ActivityDetailPage Page", "order": 6},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityDetailPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_activitydetailpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.Init"}
          }
        },
        {
          "id": "page.ActivityDetailPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_activitydetailpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitydetailpage.0001",
          "from": "page.ActivityDetailPage.Init",
          "to": "page.ActivityDetailPage.Ready",
          "event": "loadPublicActivityDetail",
          "roles": [],
          "narrative": {
            "summary": "載入公開活動詳情",
            "taskDescription": "在 ActivityDetailPage.Init 觸發 loadPublicActivityDetail 取得活動資料並完成渲染，成功後進入 ActivityDetailPage.Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_activitydetailpage.0001.01",
              "type": "semantic-check",
              "description": "若活動存在且為公開狀態：API 回 200 並包含 title/description/date/location/deadline/capacity/registered_count/status；UI 顯示完整資訊",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadPublicActivityDetail"},
          "meta": {
            "diagramId": "page_activitydetailpage",
            "source": {"raw": "ActivityDetailPage.Init --> ActivityDetailPage.Ready : loadPublicActivityDetail"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_activitydetailpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 ActivityDetailPage",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_guest",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_guest", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Guest 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Guest 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_member",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_member", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Member 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Member 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_admin",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_admin", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Admin 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Admin 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage.invokes.page_activitydetailpage.s.page_ActivityListPage_Ready.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "由列表進入活動詳情",
            "taskDescription": "在 ActivityListPage.Ready 點擊活動項目（clickActivityItem）導航到 /activities/:activityId，並進入 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 導向活動詳情頁並帶入 activityId；導覽列維持與當前身分一致（Guest 不顯示我的活動/管理後台）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickActivityItem | navigate /activities/:activityId",
            "action": "clickActivityItem",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitylistpage.s.page_ActivityDetailPage_Init.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "活動不存在時返回列表",
            "taskDescription": "在 ActivityDetailPage.Init 觸發 backToList 導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "當 activityId 不存在或不可見：API 回 404；UI 顯示不存在提示並提供回列表操作，導向 /activities",
              "expected": null
            }
          ],
          "meta": {
            "reason": "backToList | navigate /activities",
            "action": "backToList",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitylistpage.s.page_ActivityDetailPage_Ready.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "由詳情返回列表",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 clickBackToList 導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitylistpage.02",
              "type": "semantic-check",
              "description": "UI 返回活動列表；列表仍只顯示 published/full",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToList | navigate /activities",
            "action": "clickBackToList",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_guest.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_guest_GuestInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_guest", "stateId": "page.ActivityDetailPage.guest.GuestInit"},
          "narrative": {
            "summary": "切換為 Guest 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyGuestView，導向 ActivityDetailPage.Guest 差異視角並進入 GuestInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_guest.01",
              "type": "semantic-check",
              "description": "UI 以 Guest 視角渲染；不得顯示可完成報名/取消的 CTA；顯示登入提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyGuestView | navigate ActivityDetailPage.Guest",
            "action": "applyGuestView",
            "navigateTarget": "ActivityDetailPage.Guest"
          }
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_member.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_member_MemberInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberInit"},
          "narrative": {
            "summary": "切換為 Member 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyMemberView，導向 ActivityDetailPage.Member 差異視角並進入 MemberInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_member.01",
              "type": "semantic-check",
              "description": "UI 切換為 Member 視角；根據「是否已報名/是否額滿/是否已截止/是否已結束」顯示報名或取消入口或提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyMemberView | navigate ActivityDetailPage.Member",
            "action": "applyMemberView",
            "navigateTarget": "ActivityDetailPage.Member"
          }
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_admin.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_admin_AdminInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminInit"},
          "narrative": {
            "summary": "切換為 Admin 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyAdminView，導向 ActivityDetailPage.Admin 差異視角並進入 AdminInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_admin.01",
              "type": "semantic-check",
              "description": "UI 以 Admin 視角渲染 Header；顯示管理後台入口與登出，不顯示登入/註冊",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyAdminView | navigate ActivityDetailPage.Admin",
            "action": "applyAdminView",
            "navigateTarget": "ActivityDetailPage.Admin"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityDetailPage",
        "featureName": null,
        "entryStateId": "page.ActivityDetailPage.Init",
        "entryValidations": [
          {
            "id": "v.page_activitydetailpage.entry.01",
            "type": "semantic-check",
            "description": "UI 進入活動詳情頁；在資料回來前顯示 loading",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitydetailpage_guest",
      "name": "ActivityDetailPage.Guest",
      "level": "page",
      "parentDiagramId": "page_activitydetailpage",
      "roles": ["guest"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitydetailpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["guest"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑦ ActivityDetailPage.Guest（Guest 視角）", "order": 7},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityDetailPage.guest.GuestInit",
          "label": "GuestInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "guest"],
          "meta": {
            "diagramId": "page_activitydetailpage_guest",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.GuestInit"}
          }
        },
        {
          "id": "page.ActivityDetailPage.guest.GuestReady",
          "label": "GuestReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "guest"],
          "meta": {
            "diagramId": "page_activitydetailpage_guest",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.GuestReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitydetailpage_guest.0001",
          "from": "page.ActivityDetailPage.guest.GuestInit",
          "to": "page.ActivityDetailPage.guest.GuestReady",
          "event": "renderGuestActions",
          "roles": ["guest"],
          "narrative": {
            "summary": "渲染 Guest 詳情頁差異入口",
            "taskDescription": "在 GuestInit 觸發 renderGuestActions 顯示登入提示，完成後進入 GuestReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitydetailpage_guest.0001.01",
              "type": "semantic-check",
              "description": "UI 顯示「登入後可報名」提示；報名按鈕若存在必須不可用且引導登入",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderGuestActions"},
          "meta": {
            "diagramId": "page_activitydetailpage_guest",
            "source": {"raw": "ActivityDetailPage.GuestInit --> ActivityDetailPage.GuestReady : renderGuestActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_guest",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_guest", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Guest 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Guest 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_guest.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_guest_GuestInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_guest", "stateId": "page.ActivityDetailPage.guest.GuestInit"},
          "narrative": {
            "summary": "切換為 Guest 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyGuestView，導向 ActivityDetailPage.Guest 差異視角並進入 GuestInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_guest.01",
              "type": "semantic-check",
              "description": "UI 以 Guest 視角渲染；不得顯示可完成報名/取消的 CTA；顯示登入提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyGuestView | navigate ActivityDetailPage.Guest",
            "action": "applyGuestView",
            "navigateTarget": "ActivityDetailPage.Guest"
          }
        },
        {
          "id": "c.page_activitydetailpage_guest.invokes.page_authpage.s.page_ActivityDetailPage_guest_GuestReady.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_guest", "stateId": "page.ActivityDetailPage.guest.GuestReady"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "從詳情 Guest 視角前往登入/註冊",
            "taskDescription": "在 GuestReady 點擊登入/註冊（clickLoginOrRegister）導航到 /auth，並進入 AuthPage.Init（需保留 returnTo=/activities/:activityId）。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_guest.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 導向 /auth 並保留 returnTo=/activities/:activityId；成功登入後回到同一活動詳情",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLoginOrRegister | navigate /auth",
            "action": "clickLoginOrRegister",
            "navigateTarget": "/auth"
          }
        },
        {
          "id": "c.page_activitydetailpage_guest.invokes.page_activitydetailpage.s.page_ActivityDetailPage_guest_GuestReady.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_guest", "stateId": "page.ActivityDetailPage.guest.GuestReady"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "從 Guest 差異視角返回 Base",
            "taskDescription": "在 GuestReady 觸發 returnToBase 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_guest.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 返回 base 入口並可重新載入詳情；仍維持 Guest Header 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities/:activityId",
            "action": "returnToBase",
            "navigateTarget": "/activities/:activityId"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityDetailPage",
        "featureName": null,
        "entryStateId": "page.ActivityDetailPage.guest.GuestInit",
        "entryValidations": [
          {
            "id": "v.page_activitydetailpage_guest.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Guest 差異視角；不得出現「取消報名/我的活動/管理後台/登出」入口",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitydetailpage_member",
      "name": "ActivityDetailPage.Member",
      "level": "page",
      "parentDiagramId": "page_activitydetailpage",
      "roles": ["member"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitydetailpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑧ ActivityDetailPage.Member（Member 視角）", "order": 8},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityDetailPage.member.MemberInit",
          "label": "MemberInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "member"],
          "meta": {
            "diagramId": "page_activitydetailpage_member",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.MemberInit"}
          }
        },
        {
          "id": "page.ActivityDetailPage.member.MemberReady",
          "label": "MemberReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "member"],
          "meta": {
            "diagramId": "page_activitydetailpage_member",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.MemberReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitydetailpage_member.0001",
          "from": "page.ActivityDetailPage.member.MemberInit",
          "to": "page.ActivityDetailPage.member.MemberReady",
          "event": "renderMemberActions",
          "roles": ["member"],
          "narrative": {
            "summary": "渲染 Member 詳情頁差異操作",
            "taskDescription": "在 MemberInit 觸發 renderMemberActions 顯示報名/取消等入口，完成後進入 MemberReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitydetailpage_member.0001.01",
              "type": "semantic-check",
              "description": "UI 同步顯示 registered_count/capacity 與 status；若 status=full 且未報名則顯示額滿提示並禁止報名",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderMemberActions"},
          "meta": {
            "diagramId": "page_activitydetailpage_member",
            "source": {"raw": "ActivityDetailPage.MemberInit --> ActivityDetailPage.MemberReady : renderMemberActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_member",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_member", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Member 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Member 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_member.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_member_MemberInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberInit"},
          "narrative": {
            "summary": "切換為 Member 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyMemberView，導向 ActivityDetailPage.Member 差異視角並進入 MemberInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_member.01",
              "type": "semantic-check",
              "description": "UI 切換為 Member 視角；根據「是否已報名/是否額滿/是否已截止/是否已結束」顯示報名或取消入口或提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyMemberView | navigate ActivityDetailPage.Member",
            "action": "applyMemberView",
            "navigateTarget": "ActivityDetailPage.Member"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_registeractivityfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_RegisterActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Init"},
          "narrative": {
            "summary": "從詳情觸發報名功能",
            "taskDescription": "在 MemberReady 點擊報名（clickRegisterFromDetail）進入 RegisterActivityFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.feature_registeractivityfeature.01",
              "type": "semantic-check",
              "description": "送出報名時按鈕 disabled 且顯示 loading；若重送請求不得產生重複報名（同一 user+activity 最多一筆有效報名）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickRegisterFromDetail | navigate RegisterActivityFeature",
            "action": "clickRegisterFromDetail",
            "navigateTarget": "RegisterActivityFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_cancelregistrationfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從詳情觸發取消報名功能",
            "taskDescription": "在 MemberReady 點擊取消報名（clickCancelFromDetail）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.feature_cancelregistrationfeature.01",
              "type": "semantic-check",
              "description": "送出取消時按鈕 disabled 且顯示 loading；取消成功後 UI 需立刻反映名額釋放與狀態更新",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickCancelFromDetail | navigate CancelRegistrationFeature",
            "action": "clickCancelFromDetail",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.page_myactivitiespage.s.page_ActivityDetailPage_member_MemberReady.to.page_MyActivitiesPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Init"},
          "narrative": {
            "summary": "前往我的活動頁",
            "taskDescription": "在 MemberReady 點擊我的活動（clickMyActivities）導航到 /my-activities，並進入 MyActivitiesPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.page_myactivitiespage.01",
              "type": "semantic-check",
              "description": "UI 導向我的活動；已報名活動必須可在清單中看到，已取消的活動不得顯示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickMyActivities | navigate /my-activities",
            "action": "clickMyActivities",
            "navigateTarget": "/my-activities"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_logoutfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "觸發登出功能",
            "taskDescription": "在 MemberReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；詳情頁上不再出現「報名/取消」可用入口，改顯示登入提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.page_activitydetailpage.s.page_ActivityDetailPage_member_MemberReady.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "從 Member 差異視角返回 Base",
            "taskDescription": "在 MemberReady 觸發 returnToBase 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 回到 base 入口並重新載入/重整活動詳情；畫面不應同時出現兩個相同 CTA（例如兩個登出或兩個登入）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities/:activityId",
            "action": "returnToBase",
            "navigateTarget": "/activities/:activityId"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityDetailPage",
        "featureName": null,
        "entryStateId": "page.ActivityDetailPage.member.MemberInit",
        "entryValidations": [
          {
            "id": "v.page_activitydetailpage_member.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Member 差異視角；若已報名則顯示「取消報名」，若未報名且可報名則顯示「報名」",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_activitydetailpage_admin",
      "name": "ActivityDetailPage.Admin",
      "level": "page",
      "parentDiagramId": "page_activitydetailpage",
      "roles": ["admin"],
      "variant": {
        "kind": "delta",
        "baseDiagramId": "page_activitydetailpage",
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑨ ActivityDetailPage.Admin（Admin 視角）", "order": 9},
      "groups": [],
      "states": [
        {
          "id": "page.ActivityDetailPage.admin.AdminInit",
          "label": "AdminInit",
          "type": "start",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_activitydetailpage_admin",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.AdminInit"}
          }
        },
        {
          "id": "page.ActivityDetailPage.admin.AdminReady",
          "label": "AdminReady",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_activitydetailpage_admin",
            "synthetic": false,
            "source": {"scope": "root", "raw": "ActivityDetailPage.AdminReady"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_activitydetailpage_admin.0001",
          "from": "page.ActivityDetailPage.admin.AdminInit",
          "to": "page.ActivityDetailPage.admin.AdminReady",
          "event": "renderAdminActions",
          "roles": ["admin"],
          "narrative": {
            "summary": "渲染 Admin 詳情頁差異入口",
            "taskDescription": "在 AdminInit 觸發 renderAdminActions 呈現 Admin 導覽，完成後進入 AdminReady。"
          },
          "validations": [
            {
              "id": "v.t.page_activitydetailpage_admin.0001.01",
              "type": "semantic-check",
              "description": "UI 顯示「我的活動/管理後台/登出」入口；不重複顯示登出",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "renderAdminActions"},
          "meta": {
            "diagramId": "page_activitydetailpage_admin",
            "source": {"raw": "ActivityDetailPage.AdminInit --> ActivityDetailPage.AdminReady : renderAdminActions"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_activitydetailpage.contains.page_activitydetailpage_admin",
          "type": "contains",
          "from": {"diagramId": "page_activitydetailpage", "stateId": null},
          "to": {"diagramId": "page_activitydetailpage_admin", "stateId": null},
          "narrative": {
            "summary": "ActivityDetailPage 包含 Admin 視角差異圖",
            "taskDescription": "建立 parent/child 關聯，表示 ActivityDetailPage.Admin 是 ActivityDetailPage 的差異視角。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitydetailpage.invokes.page_activitydetailpage_admin.s.page_ActivityDetailPage_Ready.to.page_ActivityDetailPage_admin_AdminInit",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminInit"},
          "narrative": {
            "summary": "切換為 Admin 視角",
            "taskDescription": "在 ActivityDetailPage.Ready 觸發 applyAdminView，導向 ActivityDetailPage.Admin 差異視角並進入 AdminInit。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage.invokes.page_activitydetailpage_admin.01",
              "type": "semantic-check",
              "description": "UI 以 Admin 視角渲染 Header；顯示管理後台入口與登出，不顯示登入/註冊",
              "expected": null
            }
          ],
          "meta": {
            "reason": "applyAdminView | navigate ActivityDetailPage.Admin",
            "action": "applyAdminView",
            "navigateTarget": "ActivityDetailPage.Admin"
          }
        },
        {
          "id": "c.page_activitydetailpage_admin.invokes.page_myactivitiespage.s.page_ActivityDetailPage_admin_AdminReady.to.page_MyActivitiesPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminReady"},
          "to": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Init"},
          "narrative": {
            "summary": "前往我的活動頁",
            "taskDescription": "在 AdminReady 點擊我的活動（clickMyActivities）導航到 /my-activities，並進入 MyActivitiesPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_admin.invokes.page_myactivitiespage.01",
              "type": "semantic-check",
              "description": "UI 導向我的活動；Header 維持 Admin 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickMyActivities | navigate /my-activities",
            "action": "clickMyActivities",
            "navigateTarget": "/my-activities"
          }
        },
        {
          "id": "c.page_activitydetailpage_admin.invokes.page_adminactivitylistpage.s.page_ActivityDetailPage_admin_AdminReady.to.page_AdminActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminReady"},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"},
          "narrative": {
            "summary": "進入管理後台活動列表",
            "taskDescription": "在 AdminReady 點擊管理後台（clickAdminPanel）導航到 /admin/activities，並進入 AdminActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_admin.invokes.page_adminactivitylistpage.01",
              "type": "semantic-check",
              "description": "API/路由授權通過；可進入管理活動列表",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickAdminPanel | navigate /admin/activities",
            "action": "clickAdminPanel",
            "navigateTarget": "/admin/activities"
          }
        },
        {
          "id": "c.page_activitydetailpage_admin.invokes.feature_logoutfeature.s.page_ActivityDetailPage_admin_AdminReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "觸發登出功能",
            "taskDescription": "在 AdminReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_admin.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；詳情頁不再出現可用的報名/取消入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_admin.invokes.page_activitydetailpage.s.page_ActivityDetailPage_admin_AdminReady.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminReady"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "從 Admin 差異視角返回 Base",
            "taskDescription": "在 AdminReady 觸發 returnToBase 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_admin.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 返回 base 入口；Header 仍維持 Admin 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "returnToBase | navigate /activities/:activityId",
            "action": "returnToBase",
            "navigateTarget": "/activities/:activityId"
          }
        }
      ],
      "meta": {
        "pageName": "ActivityDetailPage",
        "featureName": null,
        "entryStateId": "page.ActivityDetailPage.admin.AdminInit",
        "entryValidations": [
          {
            "id": "v.page_activitydetailpage_admin.entry.01",
            "type": "semantic-check",
            "description": "UI 進入 Admin 差異視角；Header 顯示管理後台入口且不顯示登入/註冊",
            "expected": null
          }
        ]
      }
    }
    ,
    {
      "id": "page_authpage",
      "name": "AuthPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": [],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "⑩ AuthPage Page", "order": 10},
      "groups": [],
      "states": [
        {
          "id": "page.AuthPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_authpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthPage.Init"}
          }
        },
        {
          "id": "page.AuthPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_authpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_authpage.0001",
          "from": "page.AuthPage.Init",
          "to": "page.AuthPage.Ready",
          "event": "showAuthForm",
          "roles": [],
          "narrative": {
            "summary": "顯示登入/註冊表單",
            "taskDescription": "在 AuthPage.Init 觸發 showAuthForm 顯示登入/註冊表單並進入 AuthPage.Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_authpage.0001.01",
              "type": "semantic-check",
              "description": "表單欄位可輸入 email/password（註冊另含 name）；提交按鈕可用狀態依必填驗證",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "showAuthForm"},
          "meta": {
            "diagramId": "page_authpage",
            "source": {"raw": "AuthPage.Init --> AuthPage.Ready : showAuthForm"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_authpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_authpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AuthPage",
            "taskDescription": "建立 parent/child 關聯，表示 AuthPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_entry.invokes.page_authpage.s.page_Entry_Init.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_entry", "stateId": "page.Entry.Init"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "前往身分取得頁",
            "taskDescription": "在 Entry.Init 選擇登入/註冊（chooseAuth）導航到 /auth，並進入 AuthPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_entry.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 導向身分取得頁；若帶 returnTo 參數需保留，供成功後返回目標頁",
              "expected": null
            }
          ],
          "meta": {
            "reason": "chooseAuth | navigate /auth",
            "action": "chooseAuth",
            "navigateTarget": "/auth"
          }
        },
        {
          "id": "c.page_authpage.invokes.feature_authloginfeature.s.page_AuthPage_Ready.to.feature_AuthLoginFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Ready"},
          "to": {"diagramId": "feature_authloginfeature", "stateId": "feature.AuthLoginFeature.Init"},
          "narrative": {
            "summary": "送出登入",
            "taskDescription": "在 AuthPage.Ready 提交登入（submitLogin）進入 AuthLoginFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_authpage.invokes.feature_authloginfeature.01",
              "type": "semantic-check",
              "description": "送出登入時 UI 顯示 loading 且不可重複提交；API 成功後必須建立可驗證身分的 token/session",
              "expected": null
            }
          ],
          "meta": {
            "reason": "submitLogin | navigate AuthLoginFeature",
            "action": "submitLogin",
            "navigateTarget": "AuthLoginFeature"
          }
        },
        {
          "id": "c.page_authpage.invokes.feature_authregisterfeature.s.page_AuthPage_Ready.to.feature_AuthRegisterFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Ready"},
          "to": {"diagramId": "feature_authregisterfeature", "stateId": "feature.AuthRegisterFeature.Init"},
          "narrative": {
            "summary": "送出註冊",
            "taskDescription": "在 AuthPage.Ready 提交註冊（submitRegister）進入 AuthRegisterFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_authpage.invokes.feature_authregisterfeature.01",
              "type": "semantic-check",
              "description": "送出註冊時 UI 顯示 loading 且不可重複提交；註冊成功必須建立 Member 帳號（不可建立 Admin）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "submitRegister | navigate AuthRegisterFeature",
            "action": "submitRegister",
            "navigateTarget": "AuthRegisterFeature"
          }
        },
        {
          "id": "c.page_authpage.invokes.page_activitylistpage.s.page_AuthPage_Ready.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Ready"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "回到公開活動列表",
            "taskDescription": "在 AuthPage.Ready 點擊返回公開列表（clickBackToPublic）導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_authpage.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回公開活動列表；Guest Header 顯示登入/註冊，不顯示登出",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToPublic | navigate /activities",
            "action": "clickBackToPublic",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": "AuthPage",
        "featureName": null,
        "entryStateId": "page.AuthPage.Init",
        "entryValidations": [
          {
            "id": "v.page_authpage.entry.01",
            "type": "semantic-check",
            "description": "UI 顯示登入/註冊表單（同頁可切換）；Header 不顯示「我的活動/管理後台」",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_myactivitiespage",
      "name": "MyActivitiesPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": ["member", "admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member", "admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑪ MyActivitiesPage Page", "order": 11},
      "groups": [],
      "states": [
        {
          "id": "page.MyActivitiesPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_myactivitiespage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "MyActivitiesPage.Init"}
          }
        },
        {
          "id": "page.MyActivitiesPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page"],
          "meta": {
            "diagramId": "page_myactivitiespage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "MyActivitiesPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_myactivitiespage.0001",
          "from": "page.MyActivitiesPage.Init",
          "to": "page.MyActivitiesPage.Ready",
          "event": "loadMyRegistrations",
          "roles": ["member", "admin"],
          "narrative": {
            "summary": "載入我的報名活動",
            "taskDescription": "在 MyActivitiesPage.Init 觸發 loadMyRegistrations 取得我的報名清單，成功後進入 MyActivitiesPage.Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_myactivitiespage.0001.01",
              "type": "semantic-check",
              "description": "API 回 200 僅回傳目前使用者已報名且未取消的活動；UI 依活動日期排序並顯示「即將開始/已結束」",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadMyRegistrations"},
          "meta": {
            "diagramId": "page_myactivitiespage",
            "source": {"raw": "MyActivitiesPage.Init --> MyActivitiesPage.Ready : loadMyRegistrations"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_myactivitiespage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_myactivitiespage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 MyActivitiesPage",
            "taskDescription": "建立 parent/child 關聯，表示 MyActivitiesPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_myactivitiespage.invokes.page_activitydetailpage.s.page_MyActivitiesPage_Ready.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "由我的活動進入活動詳情",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊活動項目（clickActivityItem）導航到 /activities/:activityId，並進入 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_myactivitiespage.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 導向活動詳情；對應活動仍需可見（公開活動）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickActivityItem | navigate /activities/:activityId",
            "action": "clickActivityItem",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.page_myactivitiespage.invokes.feature_cancelregistrationfeature.s.page_MyActivitiesPage_Ready.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從我的活動取消報名",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊取消（clickCancelFromMyActivities）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_myactivitiespage.invokes.feature_cancelregistrationfeature.01",
              "type": "semantic-check",
              "description": "取消報名需符合規則（deadline 前且活動未結束）；不符合時 API 回應需阻擋並顯示原因",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickCancelFromMyActivities | navigate CancelRegistrationFeature",
            "action": "clickCancelFromMyActivities",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.page_myactivitiespage.invokes.feature_logoutfeature.s.page_MyActivitiesPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由我的活動登出",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_myactivitiespage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；Header 變為 Guest 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_myactivitiespage.invokes.page_activitylistpage.s.page_MyActivitiesPage_Ready.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "由我的活動返回公開列表",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊返回公開列表（clickBackToPublic）導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_myactivitiespage.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回活動列表；不會顯示 MyActivities 導覽（Guest 時必須隱藏）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToPublic | navigate /activities",
            "action": "clickBackToPublic",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": "MyActivitiesPage",
        "featureName": null,
        "entryStateId": "page.MyActivitiesPage.Init",
        "entryValidations": [
          {
            "id": "v.page_myactivitiespage.entry.01",
            "type": "semantic-check",
            "description": "若未登入：API/路由授權回 401 並導向 /auth（保留 returnTo=/my-activities）；若已登入：顯示 loading",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_adminactivitylistpage",
      "name": "AdminActivityListPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑫ AdminActivityListPage Page", "order": 12},
      "groups": [],
      "states": [
        {
          "id": "page.AdminActivityListPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminactivitylistpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminActivityListPage.Init"}
          }
        },
        {
          "id": "page.AdminActivityListPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminactivitylistpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminActivityListPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_adminactivitylistpage.0001",
          "from": "page.AdminActivityListPage.Init",
          "to": "page.AdminActivityListPage.Ready",
          "event": "loadAllActivities",
          "roles": ["admin"],
          "narrative": {
            "summary": "載入所有狀態活動",
            "taskDescription": "在 AdminActivityListPage.Init 觸發 loadAllActivities 載入所有活動並進入 Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_adminactivitylistpage.0001.01",
              "type": "semantic-check",
              "description": "API 回 200 並包含所有狀態 draft/published/full/closed/archived；UI 顯示每筆活動目前報名人數與狀態",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadAllActivities"},
          "meta": {
            "diagramId": "page_adminactivitylistpage",
            "source": {"raw": "AdminActivityListPage.Init --> AdminActivityListPage.Ready : loadAllActivities"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_adminactivitylistpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminActivityListPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminActivityListPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.page_adminactivityeditorpage.s.page_AdminActivityListPage_Ready.to.page_AdminActivityEditorPage_Init.create",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Init"},
          "narrative": {
            "summary": "建立新活動",
            "taskDescription": "在 Ready 點擊建立活動（clickCreateActivity）導航到 /admin/activities/new，並進入 AdminActivityEditorPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.page_adminactivityeditorpage.create.01",
              "type": "semantic-check",
              "description": "UI 導向建立活動頁；表單預設為 draft；capacity/date/deadline 等欄位可編輯",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickCreateActivity | navigate /admin/activities/new",
            "action": "clickCreateActivity",
            "navigateTarget": "/admin/activities/new"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.page_adminactivityeditorpage.s.page_AdminActivityListPage_Ready.to.page_AdminActivityEditorPage_Init.edit",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Init"},
          "narrative": {
            "summary": "編輯既有活動",
            "taskDescription": "在 Ready 點擊編輯（clickEditActivity）導航到 /admin/activities/:activityId/edit，並進入 AdminActivityEditorPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.page_adminactivityeditorpage.edit.01",
              "type": "semantic-check",
              "description": "UI 導向編輯頁；載入既有活動資料並可修改；修改後需更新 updated_at",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickEditActivity | navigate /admin/activities/:activityId/edit",
            "action": "clickEditActivity",
            "navigateTarget": "/admin/activities/:activityId/edit"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.page_adminregistrationspage.s.page_AdminActivityListPage_Ready.to.page_AdminRegistrationsPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Init"},
          "narrative": {
            "summary": "查看報名名單",
            "taskDescription": "在 Ready 點擊查看名單（clickViewRegistrations）導航到 /admin/activities/:activityId/registrations，並進入 AdminRegistrationsPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.page_adminregistrationspage.01",
              "type": "semantic-check",
              "description": "UI 導向報名名單頁；API 回 200 並包含姓名/email/報名時間",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickViewRegistrations | navigate /admin/activities/:activityId/registrations",
            "action": "clickViewRegistrations",
            "navigateTarget": "/admin/activities/:activityId/registrations"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.feature_activitystatusmachinefeature.s.page_AdminActivityListPage_Ready.to.feature_ActivityStatusMachineFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Init"},
          "narrative": {
            "summary": "開啟狀態變更機制",
            "taskDescription": "在 Ready 觸發 openStatusChange 進入 ActivityStatusMachineFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.feature_activitystatusmachinefeature.01",
              "type": "semantic-check",
              "description": "僅 Admin 可操作狀態變更；狀態變更需符合合法轉移（例如 draft→published、published/full→closed、closed/draft→archived）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "openStatusChange | navigate ActivityStatusMachineFeature",
            "action": "openStatusChange",
            "navigateTarget": "ActivityStatusMachineFeature"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.page_activitylistpage.s.page_AdminActivityListPage_Ready.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "回到公開活動列表",
            "taskDescription": "在 Ready 點擊返回公開列表（clickBackToPublic）導航到 /activities，並回到 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回公開活動列表；Admin Header 仍可顯示管理後台入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToPublic | navigate /activities",
            "action": "clickBackToPublic",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.feature_logoutfeature.s.page_AdminActivityListPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由管理列表登出",
            "taskDescription": "在 Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities 並移除 Admin 導覽；再次進入 /admin/* 需重新登入",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        }
      ],
      "meta": {
        "pageName": "AdminActivityListPage",
        "featureName": null,
        "entryStateId": "page.AdminActivityListPage.Init",
        "entryValidations": [
          {
            "id": "v.page_adminactivitylistpage.entry.01",
            "type": "semantic-check",
            "description": "若非 Admin：API/路由授權回 403（Member）或 401（Guest）；Admin 進入時顯示 loading",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_adminactivityeditorpage",
      "name": "AdminActivityEditorPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑬ AdminActivityEditorPage Page", "order": 13},
      "groups": [],
      "states": [
        {
          "id": "page.AdminActivityEditorPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminactivityeditorpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminActivityEditorPage.Init"}
          }
        },
        {
          "id": "page.AdminActivityEditorPage.Editing",
          "label": "Editing",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminactivityeditorpage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminActivityEditorPage.Editing"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_adminactivityeditorpage.0001",
          "from": "page.AdminActivityEditorPage.Init",
          "to": "page.AdminActivityEditorPage.Editing",
          "event": "loadOrCreateDraft",
          "roles": ["admin"],
          "narrative": {
            "summary": "載入或建立草稿",
            "taskDescription": "在 Init 觸發 loadOrCreateDraft：建立時產生 draft；編輯時載入既有活動；成功後進入 Editing。"
          },
          "validations": [
            {
              "id": "v.t.page_adminactivityeditorpage.0001.01",
              "type": "semantic-check",
              "description": "date 必須晚於 deadline，capacity 必須為正整數（不符合需顯示表單錯誤）",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadOrCreateDraft"},
          "meta": {
            "diagramId": "page_adminactivityeditorpage",
            "source": {"raw": "AdminActivityEditorPage.Init --> AdminActivityEditorPage.Editing : loadOrCreateDraft"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_adminactivityeditorpage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminActivityEditorPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminActivityEditorPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.feature_adminupsertactivityfeature.s.page_AdminActivityEditorPage_Editing.to.feature_AdminUpsertActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "feature_adminupsertactivityfeature", "stateId": "feature.AdminUpsertActivityFeature.Init"},
          "narrative": {
            "summary": "儲存草稿或更新",
            "taskDescription": "在 Editing 點擊儲存（clickSaveDraftOrUpdate）進入 AdminUpsertActivityFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivityeditorpage.invokes.feature_adminupsertactivityfeature.01",
              "type": "semantic-check",
              "description": "送出儲存時 UI 顯示 loading 且不可重複提交；成功後資料持久化並更新 updated_at",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickSaveDraftOrUpdate | navigate AdminUpsertActivityFeature",
            "action": "clickSaveDraftOrUpdate",
            "navigateTarget": "AdminUpsertActivityFeature"
          }
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.feature_activitystatusmachinefeature.s.page_AdminActivityEditorPage_Editing.to.feature_ActivityStatusMachineFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Init"},
          "narrative": {
            "summary": "發佈/關閉/下架",
            "taskDescription": "在 Editing 點擊發佈/關閉/下架（clickPublishCloseArchive）進入 ActivityStatusMachineFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivityeditorpage.invokes.feature_activitystatusmachinefeature.01",
              "type": "semantic-check",
              "description": "發佈/關閉/下架必須符合狀態轉移規則；成功後活動狀態改變並可在管理列表即時看到",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickPublishCloseArchive | navigate ActivityStatusMachineFeature",
            "action": "clickPublishCloseArchive",
            "navigateTarget": "ActivityStatusMachineFeature"
          }
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.page_adminactivitylistpage.s.page_AdminActivityEditorPage_Editing.to.page_AdminActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"},
          "narrative": {
            "summary": "返回管理活動列表",
            "taskDescription": "在 Editing 點擊返回列表（clickBackToAdminList）導航到 /admin/activities，並回到 AdminActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivityeditorpage.invokes.page_adminactivitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回管理活動列表；列表資料與剛才編輯結果一致",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToAdminList | navigate /admin/activities",
            "action": "clickBackToAdminList",
            "navigateTarget": "/admin/activities"
          }
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.feature_logoutfeature.s.page_AdminActivityEditorPage_Editing.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由編輯頁登出",
            "taskDescription": "在 Editing 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivityeditorpage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；未登入狀態不得保留管理頁可見入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        }
      ],
      "meta": {
        "pageName": "AdminActivityEditorPage",
        "featureName": null,
        "entryStateId": "page.AdminActivityEditorPage.Init",
        "entryValidations": [
          {
            "id": "v.page_adminactivityeditorpage.entry.01",
            "type": "semantic-check",
            "description": "非 Admin 進入時被阻擋（401/403）；Admin 進入時顯示 loading 或建立草稿",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "page_adminregistrationspage",
      "name": "AdminRegistrationsPage",
      "level": "page",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑭ AdminRegistrationsPage Page", "order": 14},
      "groups": [],
      "states": [
        {
          "id": "page.AdminRegistrationsPage.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminregistrationspage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminRegistrationsPage.Init"}
          }
        },
        {
          "id": "page.AdminRegistrationsPage.Ready",
          "label": "Ready",
          "type": "normal",
          "groupId": null,
          "tags": ["page", "admin"],
          "meta": {
            "diagramId": "page_adminregistrationspage",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AdminRegistrationsPage.Ready"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.page_adminregistrationspage.0001",
          "from": "page.AdminRegistrationsPage.Init",
          "to": "page.AdminRegistrationsPage.Ready",
          "event": "loadRegistrations",
          "roles": ["admin"],
          "narrative": {
            "summary": "載入報名名單",
            "taskDescription": "在 AdminRegistrationsPage.Init 觸發 loadRegistrations 載入報名名單並進入 Ready。"
          },
          "validations": [
            {
              "id": "v.t.page_adminregistrationspage.0001.01",
              "type": "semantic-check",
              "description": "API 回 200 並包含報名名單（姓名/email/報名時間）；若無報名 UI 顯示 empty 狀態",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loadRegistrations"},
          "meta": {
            "diagramId": "page_adminregistrationspage",
            "source": {"raw": "AdminRegistrationsPage.Init --> AdminRegistrationsPage.Ready : loadRegistrations"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.page_adminregistrationspage",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "page_adminregistrationspage", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AdminRegistrationsPage",
            "taskDescription": "建立 parent/child 關聯，表示 AdminRegistrationsPage 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_adminregistrationspage.invokes.feature_adminexportregistrationscsvfeature.s.page_AdminRegistrationsPage_Ready.to.feature_AdminExportRegistrationsCsvFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Ready"},
          "to": {"diagramId": "feature_adminexportregistrationscsvfeature", "stateId": "feature.AdminExportRegistrationsCsvFeature.Init"},
          "narrative": {
            "summary": "匯出名單 CSV",
            "taskDescription": "在 Ready 點擊匯出（clickExportCsv）進入 AdminExportRegistrationsCsvFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminregistrationspage.invokes.feature_adminexportregistrationscsvfeature.01",
              "type": "semantic-check",
              "description": "匯出動作只有一個入口（頁面內）；匯出進行中顯示 loading 且避免重複觸發",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickExportCsv | navigate AdminExportRegistrationsCsvFeature",
            "action": "clickExportCsv",
            "navigateTarget": "AdminExportRegistrationsCsvFeature"
          }
        },
        {
          "id": "c.page_adminregistrationspage.invokes.page_adminactivitylistpage.s.page_AdminRegistrationsPage_Ready.to.page_AdminActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Ready"},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"},
          "narrative": {
            "summary": "回到管理列表",
            "taskDescription": "在 Ready 點擊返回列表（clickBackToAdminList）導航到 /admin/activities，並回到 AdminActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminregistrationspage.invokes.page_adminactivitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回管理列表；不需重新登入",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickBackToAdminList | navigate /admin/activities",
            "action": "clickBackToAdminList",
            "navigateTarget": "/admin/activities"
          }
        },
        {
          "id": "c.page_adminregistrationspage.invokes.feature_logoutfeature.s.page_AdminRegistrationsPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由名單頁登出",
            "taskDescription": "在 Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminregistrationspage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；再次進入名單頁需重新授權",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        }
      ],
      "meta": {
        "pageName": "AdminRegistrationsPage",
        "featureName": null,
        "entryStateId": "page.AdminRegistrationsPage.Init",
        "entryValidations": [
          {
            "id": "v.page_adminregistrationspage.entry.01",
            "type": "semantic-check",
            "description": "非 Admin 進入時被阻擋（401/403）；Admin 進入時顯示 loading",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_authloginfeature",
      "name": "AuthLoginFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": [],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "⑮ Feature: AuthLoginFeature", "order": 15},
      "groups": [],
      "states": [
        {
          "id": "feature.AuthLoginFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authloginfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthLoginFeature.Init"}
          }
        },
        {
          "id": "feature.AuthLoginFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authloginfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthLoginFeature.Submitting"}
          }
        },
        {
          "id": "feature.AuthLoginFeature.DoneMember",
          "label": "DoneMember",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authloginfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthLoginFeature.DoneMember"}
          }
        },
        {
          "id": "feature.AuthLoginFeature.DoneAdmin",
          "label": "DoneAdmin",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authloginfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthLoginFeature.DoneAdmin"}
          }
        },
        {
          "id": "feature.AuthLoginFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authloginfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthLoginFeature.Failed"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.feature_authloginfeature.0001",
          "from": "feature.AuthLoginFeature.Init",
          "to": "feature.AuthLoginFeature.Submitting",
          "event": "sendLogin",
          "roles": [],
          "narrative": {
            "summary": "送出登入請求",
            "taskDescription": "在 AuthLoginFeature.Init 觸發 sendLogin 送出登入請求並進入 Submitting。"
          },
          "validations": [
            {
              "id": "v.t.feature_authloginfeature.0001.01",
              "type": "semantic-check",
              "description": "API 送出登入；成功回應必須建立可驗證身分的 token/session；失敗回應需包含可顯示的錯誤訊息",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendLogin"},
          "meta": {
            "diagramId": "feature_authloginfeature",
            "source": {"raw": "AuthLoginFeature.Init --> AuthLoginFeature.Submitting : sendLogin"}
          }
        },
        {
          "id": "t.feature_authloginfeature.0002",
          "from": "feature.AuthLoginFeature.Submitting",
          "to": "feature.AuthLoginFeature.DoneMember",
          "event": "loginSucceededMember",
          "roles": [],
          "narrative": {
            "summary": "登入成功（Member）",
            "taskDescription": "在 Submitting 收到 loginSucceededMember，建立 Member 身分並進入 DoneMember。"
          },
          "validations": [
            {
              "id": "v.t.feature_authloginfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200 並回傳角色=member；前端保存登入狀態；Header 切換為 Member 規則",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loginSucceededMember"},
          "meta": {
            "diagramId": "feature_authloginfeature",
            "source": {"raw": "AuthLoginFeature.Submitting --> AuthLoginFeature.DoneMember : loginSucceededMember"}
          }
        },
        {
          "id": "t.feature_authloginfeature.0003",
          "from": "feature.AuthLoginFeature.Submitting",
          "to": "feature.AuthLoginFeature.DoneAdmin",
          "event": "loginSucceededAdmin",
          "roles": [],
          "narrative": {
            "summary": "登入成功（Admin）",
            "taskDescription": "在 Submitting 收到 loginSucceededAdmin，建立 Admin 身分並進入 DoneAdmin。"
          },
          "validations": [
            {
              "id": "v.t.feature_authloginfeature.0003.01",
              "type": "semantic-check",
              "description": "API 回 200 並回傳角色=admin；前端保存登入狀態；Header 顯示管理後台入口",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loginSucceededAdmin"},
          "meta": {
            "diagramId": "feature_authloginfeature",
            "source": {"raw": "AuthLoginFeature.Submitting --> AuthLoginFeature.DoneAdmin : loginSucceededAdmin"}
          }
        },
        {
          "id": "t.feature_authloginfeature.0004",
          "from": "feature.AuthLoginFeature.Submitting",
          "to": "feature.AuthLoginFeature.Failed",
          "event": "loginFailed",
          "roles": [],
          "narrative": {
            "summary": "登入失敗",
            "taskDescription": "在 Submitting 收到 loginFailed，顯示錯誤並進入 Failed。"
          },
          "validations": [
            {
              "id": "v.t.feature_authloginfeature.0004.01",
              "type": "semantic-check",
              "description": "API 回 401（或等效失敗碼）；UI 顯示登入失敗原因且允許重新輸入；不得建立登入狀態",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "loginFailed"},
          "meta": {
            "diagramId": "feature_authloginfeature",
            "source": {"raw": "AuthLoginFeature.Submitting --> AuthLoginFeature.Failed : loginFailed"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_authloginfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_authloginfeature", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AuthLoginFeature",
            "taskDescription": "建立 parent/child 關聯，表示 AuthLoginFeature 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_authpage.invokes.feature_authloginfeature.s.page_AuthPage_Ready.to.feature_AuthLoginFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Ready"},
          "to": {"diagramId": "feature_authloginfeature", "stateId": "feature.AuthLoginFeature.Init"},
          "narrative": {
            "summary": "送出登入",
            "taskDescription": "在 AuthPage.Ready 提交登入（submitLogin）進入 AuthLoginFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_authpage.invokes.feature_authloginfeature.01",
              "type": "semantic-check",
              "description": "送出登入時 UI 顯示 loading 且不可重複提交；API 成功後必須建立可驗證身分的 token/session",
              "expected": null
            }
          ],
          "meta": {
            "reason": "submitLogin | navigate AuthLoginFeature",
            "action": "submitLogin",
            "navigateTarget": "AuthLoginFeature"
          }
        },
        {
          "id": "c.feature_authloginfeature.invokes.page_activitylistpage.s.feature_AuthLoginFeature_DoneMember.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_authloginfeature", "stateId": "feature.AuthLoginFeature.DoneMember"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "登入完成後前往活動列表",
            "taskDescription": "在 DoneMember 觸發 loginDone 導航到 /activities，並進入 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_authloginfeature.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 導向 /activities；若存在 returnTo 則應導回 returnTo（例如 /my-activities 或 /activities/:activityId），且不遺失目標上下文",
              "expected": null
            }
          ],
          "meta": {
            "reason": "loginDone | navigate /activities",
            "action": "loginDone",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.feature_authloginfeature.invokes.page_adminactivitylistpage.s.feature_AuthLoginFeature_DoneAdmin.to.page_AdminActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_authloginfeature", "stateId": "feature.AuthLoginFeature.DoneAdmin"},
          "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"},
          "narrative": {
            "summary": "Admin 登入完成後前往管理活動列表",
            "taskDescription": "在 DoneAdmin 觸發 loginDone 導航到 /admin/activities，並進入 AdminActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_authloginfeature.invokes.page_adminactivitylistpage.01",
              "type": "semantic-check",
              "description": "UI 導向管理活動列表；API 以 Admin 權限成功載入所有狀態活動",
              "expected": null
            }
          ],
          "meta": {
            "reason": "loginDone | navigate /admin/activities",
            "action": "loginDone",
            "navigateTarget": "/admin/activities"
          }
        },
        {
          "id": "c.feature_authloginfeature.invokes.page_authpage.s.feature_AuthLoginFeature_Failed.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_authloginfeature", "stateId": "feature.AuthLoginFeature.Failed"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "登入失敗返回身分取得頁",
            "taskDescription": "在 Failed 觸發 backToAuth 導航到 /auth，並回到 AuthPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_authloginfeature.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 返回 AuthPage；表單保留可重試狀態；不出現重複登入/註冊入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "backToAuth | navigate /auth",
            "action": "backToAuth",
            "navigateTarget": "/auth"
          }
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "AuthLoginFeature",
        "entryStateId": "feature.AuthLoginFeature.Init",
        "entryValidations": [
          {
            "id": "v.feature_authloginfeature.entry.01",
            "type": "semantic-check",
            "description": "進入登入流程後，AuthPage 的提交按鈕 disabled；若有 returnTo 需被保留",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_authregisterfeature",
      "name": "AuthRegisterFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": [],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": []
      },
      "source": {"type": "mermaid", "sectionTitle": "⑯ Feature: AuthRegisterFeature", "order": 16},
      "groups": [],
      "states": [
        {
          "id": "feature.AuthRegisterFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthRegisterFeature.Init"}
          }
        },
        {
          "id": "feature.AuthRegisterFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthRegisterFeature.Submitting"}
          }
        },
        {
          "id": "feature.AuthRegisterFeature.DoneMember",
          "label": "DoneMember",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthRegisterFeature.DoneMember"}
          }
        },
        {
          "id": "feature.AuthRegisterFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature"],
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "AuthRegisterFeature.Failed"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.feature_authregisterfeature.0001",
          "from": "feature.AuthRegisterFeature.Init",
          "to": "feature.AuthRegisterFeature.Submitting",
          "event": "sendRegister",
          "roles": [],
          "narrative": {
            "summary": "送出註冊請求",
            "taskDescription": "在 AuthRegisterFeature.Init 觸發 sendRegister 送出註冊請求並進入 Submitting。"
          },
          "validations": [
            {
              "id": "v.t.feature_authregisterfeature.0001.01",
              "type": "semantic-check",
              "description": "API 送出註冊；email 必須唯一；password 需被安全雜湊儲存；成功後建立可驗證身分的 token/session",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendRegister"},
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "source": {"raw": "AuthRegisterFeature.Init --> AuthRegisterFeature.Submitting : sendRegister"}
          }
        },
        {
          "id": "t.feature_authregisterfeature.0002",
          "from": "feature.AuthRegisterFeature.Submitting",
          "to": "feature.AuthRegisterFeature.DoneMember",
          "event": "registerSucceeded",
          "roles": [],
          "narrative": {
            "summary": "註冊成功（Member）",
            "taskDescription": "在 Submitting 收到 registerSucceeded，建立 Member 身分並進入 DoneMember。"
          },
          "validations": [
            {
              "id": "v.t.feature_authregisterfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200 並回傳角色=member；不得產生 admin；Header 切換為 Member 規則",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "registerSucceeded"},
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "source": {"raw": "AuthRegisterFeature.Submitting --> AuthRegisterFeature.DoneMember : registerSucceeded"}
          }
        },
        {
          "id": "t.feature_authregisterfeature.0003",
          "from": "feature.AuthRegisterFeature.Submitting",
          "to": "feature.AuthRegisterFeature.Failed",
          "event": "registerFailed",
          "roles": [],
          "narrative": {
            "summary": "註冊失敗",
            "taskDescription": "在 Submitting 收到 registerFailed，顯示錯誤並進入 Failed。"
          },
          "validations": [
            {
              "id": "v.t.feature_authregisterfeature.0003.01",
              "type": "semantic-check",
              "description": "若 email 已存在或資料不合法：API 回 400/409（或等效）；UI 顯示具體錯誤（例如 email 已使用）",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "registerFailed"},
          "meta": {
            "diagramId": "feature_authregisterfeature",
            "source": {"raw": "AuthRegisterFeature.Submitting --> AuthRegisterFeature.Failed : registerFailed"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_authregisterfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_authregisterfeature", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 AuthRegisterFeature",
            "taskDescription": "建立 parent/child 關聯，表示 AuthRegisterFeature 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_authpage.invokes.feature_authregisterfeature.s.page_AuthPage_Ready.to.feature_AuthRegisterFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Ready"},
          "to": {"diagramId": "feature_authregisterfeature", "stateId": "feature.AuthRegisterFeature.Init"},
          "narrative": {
            "summary": "送出註冊",
            "taskDescription": "在 AuthPage.Ready 提交註冊（submitRegister）進入 AuthRegisterFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_authpage.invokes.feature_authregisterfeature.01",
              "type": "semantic-check",
              "description": "送出註冊時 UI 顯示 loading 且不可重複提交；註冊成功必須建立 Member 帳號（不可建立 Admin）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "submitRegister | navigate AuthRegisterFeature",
            "action": "submitRegister",
            "navigateTarget": "AuthRegisterFeature"
          }
        },
        {
          "id": "c.feature_authregisterfeature.invokes.page_activitylistpage.s.feature_AuthRegisterFeature_DoneMember.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_authregisterfeature", "stateId": "feature.AuthRegisterFeature.DoneMember"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "註冊完成後前往活動列表",
            "taskDescription": "在 DoneMember 觸發 registerDone 導航到 /activities，並進入 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_authregisterfeature.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 導向 /activities；若有 returnTo 則導回 returnTo；使用者可立即看到 Member 可用導覽（我的活動、登出）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "registerDone | navigate /activities",
            "action": "registerDone",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.feature_authregisterfeature.invokes.page_authpage.s.feature_AuthRegisterFeature_Failed.to.page_AuthPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_authregisterfeature", "stateId": "feature.AuthRegisterFeature.Failed"},
          "to": {"diagramId": "page_authpage", "stateId": "page.AuthPage.Init"},
          "narrative": {
            "summary": "註冊失敗返回身分取得頁",
            "taskDescription": "在 Failed 觸發 backToAuth 導航到 /auth，並回到 AuthPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_authregisterfeature.invokes.page_authpage.01",
              "type": "semantic-check",
              "description": "UI 回到 AuthPage 並保留可重試狀態；不會誤顯示管理後台入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "backToAuth | navigate /auth",
            "action": "backToAuth",
            "navigateTarget": "/auth"
          }
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "AuthRegisterFeature",
        "entryStateId": "feature.AuthRegisterFeature.Init",
        "entryValidations": [
          {
            "id": "v.feature_authregisterfeature.entry.01",
            "type": "semantic-check",
            "description": "進入註冊流程後，提交按鈕 disabled 並顯示 loading；註冊僅能建立 Member",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_logoutfeature",
      "name": "LogoutFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["member", "admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member", "admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑰ Feature: LogoutFeature", "order": 17},
      "groups": [],
      "states": [
        {
          "id": "feature.LogoutFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature", "member", "admin"],
          "meta": {
            "diagramId": "feature_logoutfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "LogoutFeature.Init"}
          }
        },
        {
          "id": "feature.LogoutFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member", "admin"],
          "meta": {
            "diagramId": "feature_logoutfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "LogoutFeature.Submitting"}
          }
        },
        {
          "id": "feature.LogoutFeature.Done",
          "label": "Done",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member", "admin"],
          "meta": {
            "diagramId": "feature_logoutfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "LogoutFeature.Done"}
          }
        },
        {
          "id": "feature.LogoutFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member", "admin"],
          "meta": {
            "diagramId": "feature_logoutfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "LogoutFeature.Failed"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.feature_logoutfeature.0001",
          "from": "feature.LogoutFeature.Init",
          "to": "feature.LogoutFeature.Submitting",
          "event": "sendLogout",
          "roles": ["member", "admin"],
          "narrative": {
            "summary": "送出登出請求",
            "taskDescription": "在 LogoutFeature.Init 觸發 sendLogout 呼叫登出並進入 Submitting。"
          },
          "validations": [
            {
              "id": "v.t.feature_logoutfeature.0001.01",
              "type": "semantic-check",
              "description": "API 送出登出；成功後 token/session 失效；後續受保護 API 需回 401",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendLogout"},
          "meta": {
            "diagramId": "feature_logoutfeature",
            "source": {"raw": "LogoutFeature.Init --> LogoutFeature.Submitting : sendLogout"}
          }
        },
        {
          "id": "t.feature_logoutfeature.0002",
          "from": "feature.LogoutFeature.Submitting",
          "to": "feature.LogoutFeature.Done",
          "event": "logoutSucceeded",
          "roles": ["member", "admin"],
          "narrative": {
            "summary": "登出成功",
            "taskDescription": "在 Submitting 收到 logoutSucceeded，清除登入狀態並進入 Done。"
          },
          "validations": [
            {
              "id": "v.t.feature_logoutfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200；前端清除登入狀態；Header 切回 Guest 規則",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "logoutSucceeded"},
          "meta": {
            "diagramId": "feature_logoutfeature",
            "source": {"raw": "LogoutFeature.Submitting --> LogoutFeature.Done : logoutSucceeded"}
          }
        },
        {
          "id": "t.feature_logoutfeature.0003",
          "from": "feature.LogoutFeature.Submitting",
          "to": "feature.LogoutFeature.Failed",
          "event": "logoutFailed",
          "roles": ["member", "admin"],
          "narrative": {
            "summary": "登出失敗",
            "taskDescription": "在 Submitting 收到 logoutFailed，顯示錯誤並進入 Failed。"
          },
          "validations": [
            {
              "id": "v.t.feature_logoutfeature.0003.01",
              "type": "semantic-check",
              "description": "API 回 5xx 或網路失敗；UI 顯示登出失敗並保持原身分狀態不變（避免誤清除）",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "logoutFailed"},
          "meta": {
            "diagramId": "feature_logoutfeature",
            "source": {"raw": "LogoutFeature.Submitting --> LogoutFeature.Failed : logoutFailed"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_logoutfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_logoutfeature", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 LogoutFeature",
            "taskDescription": "建立 parent/child 關聯，表示 LogoutFeature 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_logoutfeature.s.page_ActivityListPage_member_MemberReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由活動列表（Member）登出",
            "taskDescription": "在 MemberReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_member.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "UI 呼叫登出；成功後回到 Guest 視角且 Header 不再顯示「我的活動/登出」",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitylistpage_admin.invokes.feature_logoutfeature.s.page_ActivityListPage_admin_AdminReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_admin", "stateId": "page.ActivityListPage.admin.AdminReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由活動列表（Admin）登出",
            "taskDescription": "在 AdminReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitylistpage_admin.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；Header 不再顯示管理後台入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_logoutfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由活動詳情（Member）登出",
            "taskDescription": "在 MemberReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_member.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；詳情頁上不再出現「報名/取消」可用入口，改顯示登入提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_admin.invokes.feature_logoutfeature.s.page_ActivityDetailPage_admin_AdminReady.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_admin", "stateId": "page.ActivityDetailPage.admin.AdminReady"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由活動詳情（Admin）登出",
            "taskDescription": "在 AdminReady 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_activitydetailpage_admin.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出後回到 Guest 視角；詳情頁不再出現可用的報名/取消入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_myactivitiespage.invokes.feature_logoutfeature.s.page_MyActivitiesPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由我的活動登出",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_myactivitiespage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；Header 變為 Guest 規則",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_adminactivitylistpage.invokes.feature_logoutfeature.s.page_AdminActivityListPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由管理列表登出",
            "taskDescription": "在 Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivitylistpage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities 並移除 Admin 導覽；再次進入 /admin/* 需重新登入",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.feature_logoutfeature.s.page_AdminActivityEditorPage_Editing.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由編輯頁登出",
            "taskDescription": "在 Editing 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminactivityeditorpage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；未登入狀態不得保留管理頁可見入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.page_adminregistrationspage.invokes.feature_logoutfeature.s.page_AdminRegistrationsPage_Ready.to.feature_LogoutFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Ready"},
          "to": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Init"},
          "narrative": {
            "summary": "由名單頁登出",
            "taskDescription": "在 Ready 點擊登出（clickLogout）進入 LogoutFeature.Init。"
          },
          "validations": [
            {
              "id": "v.c.page_adminregistrationspage.invokes.feature_logoutfeature.01",
              "type": "semantic-check",
              "description": "登出成功後返回 /activities；再次進入名單頁需重新授權",
              "expected": null
            }
          ],
          "meta": {
            "reason": "clickLogout | navigate LogoutFeature",
            "action": "clickLogout",
            "navigateTarget": "LogoutFeature"
          }
        },
        {
          "id": "c.feature_logoutfeature.invokes.page_activitylistpage.s.feature_LogoutFeature_Done.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Done"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "登出完成後回到公開活動列表",
            "taskDescription": "在 Done 觸發 logoutDone 導航到 /activities，並進入 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_logoutfeature.invokes.page_activitylistpage.01",
              "type": "semantic-check",
              "description": "UI 返回公開活動列表；不再可進入 /my-activities 或 /admin/*（需重新登入）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "logoutDone | navigate /activities",
            "action": "logoutDone",
            "navigateTarget": "/activities"
          }
        },
        {
          "id": "c.feature_logoutfeature.invokes.page_activitylistpage.s.feature_LogoutFeature_Failed.to.page_ActivityListPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_logoutfeature", "stateId": "feature.LogoutFeature.Failed"},
          "to": {"diagramId": "page_activitylistpage", "stateId": "page.ActivityListPage.Init"},
          "narrative": {
            "summary": "登出失敗導回公開活動列表",
            "taskDescription": "在 Failed 觸發 backToPublic 導航到 /activities，並進入 ActivityListPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_logoutfeature.invokes.page_activitylistpage.02",
              "type": "semantic-check",
              "description": "UI 導回 /activities 並顯示錯誤提示；若仍為已登入狀態，Header 仍顯示登出入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "backToPublic | navigate /activities",
            "action": "backToPublic",
            "navigateTarget": "/activities"
          }
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "LogoutFeature",
        "entryStateId": "feature.LogoutFeature.Init",
        "entryValidations": [
          {
            "id": "v.feature_logoutfeature.entry.01",
            "type": "semantic-check",
            "description": "任何頁面觸發登出都只能有單一入口（Header）；觸發後 UI 顯示 loading 並禁止重複點擊",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_registeractivityfeature",
      "name": "RegisterActivityFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["member"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑱ Feature: RegisterActivityFeature", "order": 18},
      "groups": [],
      "states": [
        {
          "id": "feature.RegisterActivityFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "RegisterActivityFeature.Init"}
          }
        },
        {
          "id": "feature.RegisterActivityFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "RegisterActivityFeature.Submitting"}
          }
        },
        {
          "id": "feature.RegisterActivityFeature.Done",
          "label": "Done",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "RegisterActivityFeature.Done"}
          }
        },
        {
          "id": "feature.RegisterActivityFeature.Rejected",
          "label": "Rejected",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "RegisterActivityFeature.Rejected"}
          }
        },
        {
          "id": "feature.RegisterActivityFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "RegisterActivityFeature.Failed"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.feature_registeractivityfeature.0001",
          "from": "feature.RegisterActivityFeature.Init",
          "to": "feature.RegisterActivityFeature.Submitting",
          "event": "sendRegisterRequest",
          "roles": ["member"],
          "narrative": {
            "summary": "送出活動報名請求",
            "taskDescription": "在 RegisterActivityFeature.Init 觸發 sendRegisterRequest 送出報名請求並進入 Submitting。"
          },
          "validations": [
            {
              "id": "v.t.feature_registeractivityfeature.0001.01",
              "type": "semantic-check",
              "description": "API 需驗證身分；後端以交易/原子操作避免超賣；同一 user+activity 的重送不得產生重複報名（idempotent）",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendRegisterRequest"},
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "source": {"raw": "RegisterActivityFeature.Init --> RegisterActivityFeature.Submitting : sendRegisterRequest"}
          }
        },
        {
          "id": "t.feature_registeractivityfeature.0002",
          "from": "feature.RegisterActivityFeature.Submitting",
          "to": "feature.RegisterActivityFeature.Done",
          "event": "registerSucceeded",
          "roles": ["member"],
          "narrative": {
            "summary": "報名成功",
            "taskDescription": "在 Submitting 收到 registerSucceeded，成功建立報名並進入 Done。"
          },
          "validations": [
            {
              "id": "v.t.feature_registeractivityfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200；Registration 被建立（canceled_at 為 null）；Activity.registered_count 增加；若達 capacity 則 Activity.status 變為 full；UI 顯示已報名",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "registerSucceeded"},
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "source": {"raw": "RegisterActivityFeature.Submitting --> RegisterActivityFeature.Done : registerSucceeded"}
          }
        },
        {
          "id": "t.feature_registeractivityfeature.0003",
          "from": "feature.RegisterActivityFeature.Submitting",
          "to": "feature.RegisterActivityFeature.Rejected",
          "event": "registerRejected",
          "roles": ["member"],
          "narrative": {
            "summary": "報名被拒絕",
            "taskDescription": "在 Submitting 收到 registerRejected，顯示原因並進入 Rejected。"
          },
          "validations": [
            {
              "id": "v.t.feature_registeractivityfeature.0003.01",
              "type": "semantic-check",
              "description": "若活動非 published、已過 deadline、已額滿、或已結束：API 回 400/409（或等效）；UI 顯示不可報名原因且不建立報名",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "registerRejected"},
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "source": {"raw": "RegisterActivityFeature.Submitting --> RegisterActivityFeature.Rejected : registerRejected"}
          }
        },
        {
          "id": "t.feature_registeractivityfeature.0004",
          "from": "feature.RegisterActivityFeature.Submitting",
          "to": "feature.RegisterActivityFeature.Failed",
          "event": "registerFailed",
          "roles": ["member"],
          "narrative": {
            "summary": "報名失敗",
            "taskDescription": "在 Submitting 收到 registerFailed，顯示錯誤並進入 Failed。"
          },
          "validations": [
            {
              "id": "v.t.feature_registeractivityfeature.0004.01",
              "type": "semantic-check",
              "description": "若伺服器錯誤（5xx）或網路失敗：UI 顯示操作失敗且允許重試；重試仍不得造成重複報名",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "registerFailed"},
          "meta": {
            "diagramId": "feature_registeractivityfeature",
            "source": {"raw": "RegisterActivityFeature.Submitting --> RegisterActivityFeature.Failed : registerFailed"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_registeractivityfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_registeractivityfeature", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 RegisterActivityFeature",
            "taskDescription": "建立 parent/child 關聯，表示 RegisterActivityFeature 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_registeractivityfeature.s.page_ActivityListPage_member_MemberReady.to.feature_RegisterActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Init"},
          "narrative": {
            "summary": "從列表點擊報名",
            "taskDescription": "在 MemberReady 點擊報名（clickRegisterFromList）進入 RegisterActivityFeature.Init。"
          },
          "validations": [],
          "meta": {
            "reason": "clickRegisterFromList | navigate RegisterActivityFeature",
            "action": "clickRegisterFromList",
            "navigateTarget": "RegisterActivityFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_registeractivityfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_RegisterActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Init"},
          "narrative": {
            "summary": "從詳情點擊報名",
            "taskDescription": "在 MemberReady 點擊報名（clickRegisterFromDetail）進入 RegisterActivityFeature.Init。"
          },
          "validations": [],
          "meta": {
            "reason": "clickRegisterFromDetail | navigate RegisterActivityFeature",
            "action": "clickRegisterFromDetail",
            "navigateTarget": "RegisterActivityFeature"
          }
        },
        {
          "id": "c.feature_registeractivityfeature.invokes.page_activitydetailpage.s.feature_RegisterActivityFeature_Done.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Done"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "報名完成返回活動詳情",
            "taskDescription": "在 Done 觸發 registerDoneReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_registeractivityfeature.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 回到活動詳情並重新載入；顯示「已報名」狀態與最新 registered_count/status；若因此額滿需顯示額滿提示",
              "expected": null
            }
          ],
          "meta": {
            "reason": "registerDoneReturn | navigate /activities/:activityId",
            "action": "registerDoneReturn",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.feature_registeractivityfeature.invokes.page_activitydetailpage.s.feature_RegisterActivityFeature_Rejected.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Rejected"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "報名被拒後返回活動詳情",
            "taskDescription": "在 Rejected 觸發 registerRejectedReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_registeractivityfeature.invokes.page_activitydetailpage.02",
              "type": "semantic-check",
              "description": "UI 回到詳情並顯示被拒原因（例如額滿/截止）；按鈕狀態符合規則（不可報名時 disabled 或不顯示）",
              "expected": null
            }
          ],
          "meta": {
            "reason": "registerRejectedReturn | navigate /activities/:activityId",
            "action": "registerRejectedReturn",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.feature_registeractivityfeature.invokes.page_activitydetailpage.s.feature_RegisterActivityFeature_Failed.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_registeractivityfeature", "stateId": "feature.RegisterActivityFeature.Failed"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "報名失敗返回活動詳情",
            "taskDescription": "在 Failed 觸發 registerFailedReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_registeractivityfeature.invokes.page_activitydetailpage.03",
              "type": "semantic-check",
              "description": "UI 回到詳情並顯示錯誤訊息；可再次嘗試報名時必須先解除 loading 並避免重複提交",
              "expected": null
            }
          ],
          "meta": {
            "reason": "registerFailedReturn | navigate /activities/:activityId",
            "action": "registerFailedReturn",
            "navigateTarget": "/activities/:activityId"
          }
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "RegisterActivityFeature",
        "entryStateId": "feature.RegisterActivityFeature.Init",
        "entryValidations": [
          {
            "id": "v.feature_registeractivityfeature.entry.01",
            "type": "semantic-check",
            "description": "觸發報名前需確認已登入（否則應先導向 /auth）；UI 顯示送出中並鎖定按鈕",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_cancelregistrationfeature",
      "name": "CancelRegistrationFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["member"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["member"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑲ Feature: CancelRegistrationFeature", "order": 19},
      "groups": [],
      "states": [
        {
          "id": "feature.CancelRegistrationFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "CancelRegistrationFeature.Init"}
          }
        },
        {
          "id": "feature.CancelRegistrationFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "CancelRegistrationFeature.Submitting"}
          }
        },
        {
          "id": "feature.CancelRegistrationFeature.Done",
          "label": "Done",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "CancelRegistrationFeature.Done"}
          }
        },
        {
          "id": "feature.CancelRegistrationFeature.Rejected",
          "label": "Rejected",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "CancelRegistrationFeature.Rejected"}
          }
        },
        {
          "id": "feature.CancelRegistrationFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "member"],
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "synthetic": false,
            "source": {"scope": "root", "raw": "CancelRegistrationFeature.Failed"}
          }
        }
      ],
      "transitions": [
        {
          "id": "t.feature_cancelregistrationfeature.0001",
          "from": "feature.CancelRegistrationFeature.Init",
          "to": "feature.CancelRegistrationFeature.Submitting",
          "event": "sendCancelRequest",
          "roles": ["member"],
          "narrative": {
            "summary": "送出取消報名請求",
            "taskDescription": "在 CancelRegistrationFeature.Init 觸發 sendCancelRequest 送出取消請求並進入 Submitting。"
          },
          "validations": [
            {
              "id": "v.t.feature_cancelregistrationfeature.0001.01",
              "type": "semantic-check",
              "description": "API 需驗證身分；後端以交易/原子操作更新 canceled_at、同步更新 Activity.registered_count，必要時 status 從 full 回到 published",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendCancelRequest"},
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "source": {"raw": "CancelRegistrationFeature.Init --> CancelRegistrationFeature.Submitting : sendCancelRequest"}
          }
        },
        {
          "id": "t.feature_cancelregistrationfeature.0002",
          "from": "feature.CancelRegistrationFeature.Submitting",
          "to": "feature.CancelRegistrationFeature.Done",
          "event": "cancelSucceeded",
          "roles": ["member"],
          "narrative": {
            "summary": "取消成功",
            "taskDescription": "在 Submitting 收到 cancelSucceeded，成功取消報名並進入 Done。"
          },
          "validations": [
            {
              "id": "v.t.feature_cancelregistrationfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200；Registration.canceled_at 被寫入；Activity.registered_count 減少；若原為 full 且釋放名額且仍可報名則 status 回 published；UI 顯示未報名",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "cancelSucceeded"},
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "source": {"raw": "CancelRegistrationFeature.Submitting --> CancelRegistrationFeature.Done : cancelSucceeded"}
          }
        },
        {
          "id": "t.feature_cancelregistrationfeature.0003",
          "from": "feature.CancelRegistrationFeature.Submitting",
          "to": "feature.CancelRegistrationFeature.Rejected",
          "event": "cancelRejected",
          "roles": ["member"],
          "narrative": {
            "summary": "取消被拒絕",
            "taskDescription": "在 Submitting 收到 cancelRejected，顯示原因並進入 Rejected。"
          },
          "validations": [
            {
              "id": "v.t.feature_cancelregistrationfeature.0003.01",
              "type": "semantic-check",
              "description": "若已過 deadline、活動已結束、或根本未報名：API 回 400/409（或等效）；UI 顯示不可取消原因",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "cancelRejected"},
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "source": {"raw": "CancelRegistrationFeature.Submitting --> CancelRegistrationFeature.Rejected : cancelRejected"}
          }
        },
        {
          "id": "t.feature_cancelregistrationfeature.0004",
          "from": "feature.CancelRegistrationFeature.Submitting",
          "to": "feature.CancelRegistrationFeature.Failed",
          "event": "cancelFailed",
          "roles": ["member"],
          "narrative": {
            "summary": "取消失敗",
            "taskDescription": "在 Submitting 收到 cancelFailed，顯示錯誤並進入 Failed。"
          },
          "validations": [
            {
              "id": "v.t.feature_cancelregistrationfeature.0004.01",
              "type": "semantic-check",
              "description": "若 5xx 或網路失敗：UI 顯示取消失敗；允許重試且不造成資料不一致（不會多次扣名額）",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "cancelFailed"},
          "meta": {
            "diagramId": "feature_cancelregistrationfeature",
            "source": {"raw": "CancelRegistrationFeature.Submitting --> CancelRegistrationFeature.Failed : cancelFailed"}
          }
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_cancelregistrationfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": null},
          "narrative": {
            "summary": "Entry 包含 CancelRegistrationFeature",
            "taskDescription": "建立 parent/child 關聯，表示 CancelRegistrationFeature 隸屬於 Entry。"
          },
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_activitylistpage_member.invokes.feature_cancelregistrationfeature.s.page_ActivityListPage_member_MemberReady.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitylistpage_member", "stateId": "page.ActivityListPage.member.MemberReady"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從列表點擊取消報名",
            "taskDescription": "在 MemberReady 點擊取消報名（clickCancelFromList）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [],
          "meta": {
            "reason": "clickCancelFromList | navigate CancelRegistrationFeature",
            "action": "clickCancelFromList",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.page_activitydetailpage_member.invokes.feature_cancelregistrationfeature.s.page_ActivityDetailPage_member_MemberReady.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_activitydetailpage_member", "stateId": "page.ActivityDetailPage.member.MemberReady"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從詳情點擊取消報名",
            "taskDescription": "在 MemberReady 點擊取消報名（clickCancelFromDetail）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [],
          "meta": {
            "reason": "clickCancelFromDetail | navigate CancelRegistrationFeature",
            "action": "clickCancelFromDetail",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.page_myactivitiespage.invokes.feature_cancelregistrationfeature.s.page_MyActivitiesPage_Ready.to.feature_CancelRegistrationFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_myactivitiespage", "stateId": "page.MyActivitiesPage.Ready"},
          "to": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Init"},
          "narrative": {
            "summary": "從我的活動取消報名",
            "taskDescription": "在 MyActivitiesPage.Ready 點擊取消（clickCancelFromMyActivities）進入 CancelRegistrationFeature.Init。"
          },
          "validations": [],
          "meta": {
            "reason": "clickCancelFromMyActivities | navigate CancelRegistrationFeature",
            "action": "clickCancelFromMyActivities",
            "navigateTarget": "CancelRegistrationFeature"
          }
        },
        {
          "id": "c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.s.feature_CancelRegistrationFeature_Done.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Done"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "取消完成返回活動詳情",
            "taskDescription": "在 Done 觸發 cancelDoneReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.01",
              "type": "semantic-check",
              "description": "UI 回到詳情並重新載入；registered_count/status 與後端一致；若釋放後未額滿且仍可報名則顯示可報名",
              "expected": null
            }
          ],
          "meta": {
            "reason": "cancelDoneReturn | navigate /activities/:activityId",
            "action": "cancelDoneReturn",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.s.feature_CancelRegistrationFeature_Rejected.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Rejected"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "取消被拒後返回活動詳情",
            "taskDescription": "在 Rejected 觸發 cancelRejectedReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.02",
              "type": "semantic-check",
              "description": "UI 回到詳情並顯示拒絕原因；若規則禁止取消則不應顯示可點擊的取消入口",
              "expected": null
            }
          ],
          "meta": {
            "reason": "cancelRejectedReturn | navigate /activities/:activityId",
            "action": "cancelRejectedReturn",
            "navigateTarget": "/activities/:activityId"
          }
        },
        {
          "id": "c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.s.feature_CancelRegistrationFeature_Failed.to.page_ActivityDetailPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_cancelregistrationfeature", "stateId": "feature.CancelRegistrationFeature.Failed"},
          "to": {"diagramId": "page_activitydetailpage", "stateId": "page.ActivityDetailPage.Init"},
          "narrative": {
            "summary": "取消失敗返回活動詳情",
            "taskDescription": "在 Failed 觸發 cancelFailedReturn 導航到 /activities/:activityId，並回到 ActivityDetailPage.Init。"
          },
          "validations": [
            {
              "id": "v.c.feature_cancelregistrationfeature.invokes.page_activitydetailpage.03",
              "type": "semantic-check",
              "description": "UI 回到詳情並顯示錯誤訊息；可再次嘗試取消時必須先解除 loading 並避免重複提交",
              "expected": null
            }
          ],
          "meta": {
            "reason": "cancelFailedReturn | navigate /activities/:activityId",
            "action": "cancelFailedReturn",
            "navigateTarget": "/activities/:activityId"
          }
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "CancelRegistrationFeature",
        "entryStateId": "feature.CancelRegistrationFeature.Init",
        "entryValidations": [
          {
            "id": "v.feature_cancelregistrationfeature.entry.01",
            "type": "semantic-check",
            "description": "取消報名前需確認使用者對該活動已有有效報名；UI 顯示送出中並鎖定按鈕",
            "expected": null
          }
        ]
      }
    },
    {
      "id": "feature_adminupsertactivityfeature",
      "name": "AdminUpsertActivityFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "⑳ Feature: AdminUpsertActivityFeature", "order": 20},
      "groups": [],
      "states": [
        {
          "id": "feature.AdminUpsertActivityFeature.Init",
          "label": "Init",
          "type": "start",
          "groupId": null,
          "tags": ["feature", "admin"],
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminUpsertActivityFeature.Init"}}
        },
        {
          "id": "feature.AdminUpsertActivityFeature.Submitting",
          "label": "Submitting",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "admin"],
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminUpsertActivityFeature.Submitting"}}
        },
        {
          "id": "feature.AdminUpsertActivityFeature.Done",
          "label": "Done",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "admin"],
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminUpsertActivityFeature.Done"}}
        },
        {
          "id": "feature.AdminUpsertActivityFeature.Failed",
          "label": "Failed",
          "type": "normal",
          "groupId": null,
          "tags": ["feature", "admin"],
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminUpsertActivityFeature.Failed"}}
        }
      ],
      "transitions": [
        {
          "id": "t.feature_adminupsertactivityfeature.0001",
          "from": "feature.AdminUpsertActivityFeature.Init",
          "to": "feature.AdminUpsertActivityFeature.Submitting",
          "event": "sendUpsert",
          "roles": ["admin"],
          "narrative": {"summary": "送出新增/更新活動", "taskDescription": "在 AdminUpsertActivityFeature.Init 觸發 sendUpsert 並進入 Submitting。"},
          "validations": [
            {
              "id": "v.t.feature_adminupsertactivityfeature.0001.01",
              "type": "semantic-check",
              "description": "API 驗證 Admin 權限；驗證 date > deadline、capacity 為正整數；成功後更新 Activity.updated_at",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "sendUpsert"},
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "source": {"raw": "AdminUpsertActivityFeature.Init --> AdminUpsertActivityFeature.Submitting : sendUpsert"}}
        },
        {
          "id": "t.feature_adminupsertactivityfeature.0002",
          "from": "feature.AdminUpsertActivityFeature.Submitting",
          "to": "feature.AdminUpsertActivityFeature.Done",
          "event": "upsertSucceeded",
          "roles": ["admin"],
          "narrative": {"summary": "新增/更新成功", "taskDescription": "在 Submitting 收到 upsertSucceeded，進入 Done。"},
          "validations": [
            {
              "id": "v.t.feature_adminupsertactivityfeature.0002.01",
              "type": "semantic-check",
              "description": "API 回 200；Activity 欄位與表單一致；若為新建則 created_by 設為當前 Admin",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "upsertSucceeded"},
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "source": {"raw": "AdminUpsertActivityFeature.Submitting --> AdminUpsertActivityFeature.Done : upsertSucceeded"}}
        },
        {
          "id": "t.feature_adminupsertactivityfeature.0003",
          "from": "feature.AdminUpsertActivityFeature.Submitting",
          "to": "feature.AdminUpsertActivityFeature.Failed",
          "event": "upsertFailed",
          "roles": ["admin"],
          "narrative": {"summary": "新增/更新失敗", "taskDescription": "在 Submitting 收到 upsertFailed，進入 Failed。"},
          "validations": [
            {
              "id": "v.t.feature_adminupsertactivityfeature.0003.01",
              "type": "semantic-check",
              "description": "若驗證失敗：API 回 400 並回傳欄位錯誤；若 5xx：顯示操作失敗並允許重試；不得造成部分寫入",
              "expected": null
            }
          ],
          "intent": {"category": "action", "summary": "upsertFailed"},
          "meta": {"diagramId": "feature_adminupsertactivityfeature", "source": {"raw": "AdminUpsertActivityFeature.Submitting --> AdminUpsertActivityFeature.Failed : upsertFailed"}}
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_adminupsertactivityfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_adminupsertactivityfeature", "stateId": null},
          "narrative": {"summary": "Entry 包含 AdminUpsertActivityFeature", "taskDescription": "建立 parent/child 關聯，表示 AdminUpsertActivityFeature 隸屬於 Entry。"},
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_adminactivityeditorpage.invokes.feature_adminupsertactivityfeature.s.page_AdminActivityEditorPage_Editing.to.feature_AdminUpsertActivityFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"},
          "to": {"diagramId": "feature_adminupsertactivityfeature", "stateId": "feature.AdminUpsertActivityFeature.Init"},
          "narrative": {"summary": "在編輯頁點擊儲存/更新", "taskDescription": "在 Editing 點擊 clickSaveDraftOrUpdate 進入 AdminUpsertActivityFeature.Init。"},
          "validations": [],
          "meta": {"reason": "clickSaveDraftOrUpdate | navigate AdminUpsertActivityFeature", "action": "clickSaveDraftOrUpdate", "navigateTarget": "AdminUpsertActivityFeature"}
        },
        {
          "id": "c.feature_adminupsertactivityfeature.invokes.page_adminactivityeditorpage.s.feature_AdminUpsertActivityFeature_Done.to.page_AdminActivityEditorPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_adminupsertactivityfeature", "stateId": "feature.AdminUpsertActivityFeature.Done"},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Init"},
          "narrative": {"summary": "儲存完成返回編輯頁", "taskDescription": "在 Done 觸發 upsertDoneReturn 導航到 /admin/activities/:activityId/edit，並回到 AdminActivityEditorPage.Init。"},
          "validations": [
            {"id": "v.c.feature_adminupsertactivityfeature.invokes.page_adminactivityeditorpage.01", "type": "semantic-check", "description": "UI 回到編輯頁並載入最新資料；狀態仍維持（通常為 draft 或原狀態）", "expected": null}
          ],
          "meta": {"reason": "upsertDoneReturn | navigate /admin/activities/:activityId/edit", "action": "upsertDoneReturn", "navigateTarget": "/admin/activities/:activityId/edit"}
        },
        {
          "id": "c.feature_adminupsertactivityfeature.invokes.page_adminactivityeditorpage.s.feature_AdminUpsertActivityFeature_Failed.to.page_AdminActivityEditorPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_adminupsertactivityfeature", "stateId": "feature.AdminUpsertActivityFeature.Failed"},
          "to": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Init"},
          "narrative": {"summary": "儲存失敗返回編輯頁", "taskDescription": "在 Failed 觸發 backToEditor 導航到 /admin/activities/:activityId/edit，並回到 AdminActivityEditorPage.Init。"},
          "validations": [
            {"id": "v.c.feature_adminupsertactivityfeature.invokes.page_adminactivityeditorpage.02", "type": "semantic-check", "description": "UI 回到編輯頁並顯示錯誤；表單資料保留可修正；不會重複出現相同 CTA", "expected": null}
          ],
          "meta": {"reason": "backToEditor | navigate /admin/activities/:activityId/edit", "action": "backToEditor", "navigateTarget": "/admin/activities/:activityId/edit"}
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "AdminUpsertActivityFeature",
        "entryStateId": "feature.AdminUpsertActivityFeature.Init",
        "entryValidations": [
          {"id": "v.feature_adminupsertactivityfeature.entry.01", "type": "semantic-check", "description": "僅 Admin 可進入；表單提交中按鈕 disabled 並顯示 loading", "expected": null}
        ]
      }
    },
    {
      "id": "feature_adminexportregistrationscsvfeature",
      "name": "AdminExportRegistrationsCsvFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "㉑ Feature: AdminExportRegistrationsCsvFeature", "order": 21},
      "groups": [],
      "states": [
        {"id": "feature.AdminExportRegistrationsCsvFeature.Init", "label": "Init", "type": "start", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminExportRegistrationsCsvFeature.Init"}}},
        {"id": "feature.AdminExportRegistrationsCsvFeature.Exporting", "label": "Exporting", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminExportRegistrationsCsvFeature.Exporting"}}},
        {"id": "feature.AdminExportRegistrationsCsvFeature.Done", "label": "Done", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminExportRegistrationsCsvFeature.Done"}}},
        {"id": "feature.AdminExportRegistrationsCsvFeature.Failed", "label": "Failed", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "synthetic": false, "source": {"scope": "root", "raw": "AdminExportRegistrationsCsvFeature.Failed"}}}
      ],
      "transitions": [
        {
          "id": "t.feature_adminexportregistrationscsvfeature.0001",
          "from": "feature.AdminExportRegistrationsCsvFeature.Init",
          "to": "feature.AdminExportRegistrationsCsvFeature.Exporting",
          "event": "startExport",
          "roles": ["admin"],
          "narrative": {"summary": "開始匯出 CSV", "taskDescription": "在 Init 觸發 startExport 並進入 Exporting。"},
          "validations": [
            {"id": "v.t.feature_adminexportregistrationscsvfeature.0001.01", "type": "semantic-check", "description": "API 產出 CSV（或回傳可下載檔案/串流）；內容欄位包含姓名/email/報名時間；匯出行為需被 AuditLog 記錄", "expected": null}
          ],
          "intent": {"category": "action", "summary": "startExport"},
          "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "source": {"raw": "AdminExportRegistrationsCsvFeature.Init --> AdminExportRegistrationsCsvFeature.Exporting : startExport"}}
        },
        {
          "id": "t.feature_adminexportregistrationscsvfeature.0002",
          "from": "feature.AdminExportRegistrationsCsvFeature.Exporting",
          "to": "feature.AdminExportRegistrationsCsvFeature.Done",
          "event": "exportSucceeded",
          "roles": ["admin"],
          "narrative": {"summary": "匯出成功", "taskDescription": "在 Exporting 收到 exportSucceeded，進入 Done。"},
          "validations": [
            {"id": "v.t.feature_adminexportregistrationscsvfeature.0002.01", "type": "semantic-check", "description": "匯出成功後瀏覽器觸發下載；檔案內容筆數與當前名單一致", "expected": null}
          ],
          "intent": {"category": "action", "summary": "exportSucceeded"},
          "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "source": {"raw": "AdminExportRegistrationsCsvFeature.Exporting --> AdminExportRegistrationsCsvFeature.Done : exportSucceeded"}}
        },
        {
          "id": "t.feature_adminexportregistrationscsvfeature.0003",
          "from": "feature.AdminExportRegistrationsCsvFeature.Exporting",
          "to": "feature.AdminExportRegistrationsCsvFeature.Failed",
          "event": "exportFailed",
          "roles": ["admin"],
          "narrative": {"summary": "匯出失敗", "taskDescription": "在 Exporting 收到 exportFailed，進入 Failed。"},
          "validations": [
            {"id": "v.t.feature_adminexportregistrationscsvfeature.0003.01", "type": "semantic-check", "description": "若匯出失敗（5xx/網路）：UI 顯示錯誤提示並允許重試；不產生重複下載行為", "expected": null}
          ],
          "intent": {"category": "action", "summary": "exportFailed"},
          "meta": {"diagramId": "feature_adminexportregistrationscsvfeature", "source": {"raw": "AdminExportRegistrationsCsvFeature.Exporting --> AdminExportRegistrationsCsvFeature.Failed : exportFailed"}}
        }
      ],
      "connectors": [
        {
          "id": "c.page_entry.contains.feature_adminexportregistrationscsvfeature",
          "type": "contains",
          "from": {"diagramId": "page_entry", "stateId": null},
          "to": {"diagramId": "feature_adminexportregistrationscsvfeature", "stateId": null},
          "narrative": {"summary": "Entry 包含 AdminExportRegistrationsCsvFeature", "taskDescription": "建立 parent/child 關聯，表示 AdminExportRegistrationsCsvFeature 隸屬於 Entry。"},
          "validations": [],
          "meta": {"reason": "derived from parentDiagramId"}
        },
        {
          "id": "c.page_adminregistrationspage.invokes.feature_adminexportregistrationscsvfeature.s.page_AdminRegistrationsPage_Ready.to.feature_AdminExportRegistrationsCsvFeature_Init",
          "type": "invokes",
          "from": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Ready"},
          "to": {"diagramId": "feature_adminexportregistrationscsvfeature", "stateId": "feature.AdminExportRegistrationsCsvFeature.Init"},
          "narrative": {"summary": "在名單頁點擊匯出 CSV", "taskDescription": "在 Ready 點擊 clickExportCsv 進入 AdminExportRegistrationsCsvFeature.Init。"},
          "validations": [],
          "meta": {"reason": "clickExportCsv | navigate AdminExportRegistrationsCsvFeature", "action": "clickExportCsv", "navigateTarget": "AdminExportRegistrationsCsvFeature"}
        },
        {
          "id": "c.feature_adminexportregistrationscsvfeature.invokes.page_adminregistrationspage.s.feature_AdminExportRegistrationsCsvFeature_Done.to.page_AdminRegistrationsPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_adminexportregistrationscsvfeature", "stateId": "feature.AdminExportRegistrationsCsvFeature.Done"},
          "to": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Init"},
          "narrative": {"summary": "匯出完成返回名單頁", "taskDescription": "在 Done 觸發 exportDoneReturn 導航到 /admin/activities/:activityId/registrations，並回到 AdminRegistrationsPage.Init。"},
          "validations": [
            {"id": "v.c.feature_adminexportregistrationscsvfeature.invokes.page_adminregistrationspage.01", "type": "semantic-check", "description": "UI 回到名單頁；名單仍可正常載入；匯出入口仍為單一且可用", "expected": null}
          ],
          "meta": {"reason": "exportDoneReturn | navigate /admin/activities/:activityId/registrations", "action": "exportDoneReturn", "navigateTarget": "/admin/activities/:activityId/registrations"}
        },
        {
          "id": "c.feature_adminexportregistrationscsvfeature.invokes.page_adminregistrationspage.s.feature_AdminExportRegistrationsCsvFeature_Failed.to.page_AdminRegistrationsPage_Init",
          "type": "invokes",
          "from": {"diagramId": "feature_adminexportregistrationscsvfeature", "stateId": "feature.AdminExportRegistrationsCsvFeature.Failed"},
          "to": {"diagramId": "page_adminregistrationspage", "stateId": "page.AdminRegistrationsPage.Init"},
          "narrative": {"summary": "匯出失敗返回名單頁", "taskDescription": "在 Failed 觸發 exportFailedReturn 導航到 /admin/activities/:activityId/registrations，並回到 AdminRegistrationsPage.Init。"},
          "validations": [
            {"id": "v.c.feature_adminexportregistrationscsvfeature.invokes.page_adminregistrationspage.02", "type": "semantic-check", "description": "UI 回到名單頁並顯示匯出失敗訊息；可再次點擊匯出", "expected": null}
          ],
          "meta": {"reason": "exportFailedReturn | navigate /admin/activities/:activityId/registrations", "action": "exportFailedReturn", "navigateTarget": "/admin/activities/:activityId/registrations"}
        }
      ],
      "meta": {
        "pageName": null,
        "featureName": "AdminExportRegistrationsCsvFeature",
        "entryStateId": "feature.AdminExportRegistrationsCsvFeature.Init",
        "entryValidations": [
          {"id": "v.feature_adminexportregistrationscsvfeature.entry.01", "type": "semantic-check", "description": "僅 Admin 可匯出；匯出按鈕進入 loading 並避免重複觸發", "expected": null}
        ]
      }
    },
    {
      "id": "feature_activitystatusmachinefeature",
      "name": "ActivityStatusMachineFeature",
      "level": "feature",
      "parentDiagramId": "page_entry",
      "roles": ["admin"],
      "variant": {
        "kind": "standalone",
        "baseDiagramId": null,
        "deltaDiagramIdsByRole": {},
        "appliesToRoles": ["admin"]
      },
      "source": {"type": "mermaid", "sectionTitle": "㉒ Feature: ActivityStatusMachineFeature", "order": 22},
      "groups": [],
      "states": [
        {"id": "feature.ActivityStatusMachineFeature.Init", "label": "Init", "type": "start", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Init"}}},
        {"id": "feature.ActivityStatusMachineFeature.Draft", "label": "Draft", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Draft"}}},
        {"id": "feature.ActivityStatusMachineFeature.Published", "label": "Published", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Published"}}},
        {"id": "feature.ActivityStatusMachineFeature.Full", "label": "Full", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Full"}}},
        {"id": "feature.ActivityStatusMachineFeature.Closed", "label": "Closed", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Closed"}}},
        {"id": "feature.ActivityStatusMachineFeature.Archived", "label": "Archived", "type": "normal", "groupId": null, "tags": ["feature", "admin"], "meta": {"diagramId": "feature_activitystatusmachinefeature", "synthetic": false, "source": {"scope": "root", "raw": "ActivityStatusMachineFeature.Archived"}}}
      ],
      "transitions": [
        {"id": "t.feature_activitystatusmachinefeature.0001", "from": "feature.ActivityStatusMachineFeature.Init", "to": "feature.ActivityStatusMachineFeature.Draft", "event": "asDraft", "roles": ["admin"], "narrative": {"summary": "顯示 draft 狀態", "taskDescription": "在 Init 觸發 asDraft 進入 Draft。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0001.01", "type": "semantic-check", "description": "目前活動 status 為 draft；公開列表/詳情不可見；僅管理後台可見", "expected": null}], "intent": {"category": "action", "summary": "asDraft"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Init --> ActivityStatusMachineFeature.Draft : asDraft"}}},
        {"id": "t.feature_activitystatusmachinefeature.0002", "from": "feature.ActivityStatusMachineFeature.Init", "to": "feature.ActivityStatusMachineFeature.Published", "event": "asPublished", "roles": ["admin"], "narrative": {"summary": "顯示 published 狀態", "taskDescription": "在 Init 觸發 asPublished 進入 Published。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0002.01", "type": "semantic-check", "description": "目前活動 status 為 published；公開列表/詳情可見；若未過 deadline 且未額滿則允許報名", "expected": null}], "intent": {"category": "action", "summary": "asPublished"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Init --> ActivityStatusMachineFeature.Published : asPublished"}}},
        {"id": "t.feature_activitystatusmachinefeature.0003", "from": "feature.ActivityStatusMachineFeature.Init", "to": "feature.ActivityStatusMachineFeature.Full", "event": "asFull", "roles": ["admin"], "narrative": {"summary": "顯示 full 狀態", "taskDescription": "在 Init 觸發 asFull 進入 Full。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0003.01", "type": "semantic-check", "description": "目前活動 status 為 full；公開列表可見但不可再報名；registered_count 必須等於 capacity", "expected": null}], "intent": {"category": "action", "summary": "asFull"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Init --> ActivityStatusMachineFeature.Full : asFull"}}},
        {"id": "t.feature_activitystatusmachinefeature.0004", "from": "feature.ActivityStatusMachineFeature.Init", "to": "feature.ActivityStatusMachineFeature.Closed", "event": "asClosed", "roles": ["admin"], "narrative": {"summary": "顯示 closed 狀態", "taskDescription": "在 Init 觸發 asClosed 進入 Closed。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0004.01", "type": "semantic-check", "description": "目前活動 status 為 closed；公開列表/詳情不可見（或依 Step1 規則視為非公開）；不可報名", "expected": null}], "intent": {"category": "action", "summary": "asClosed"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Init --> ActivityStatusMachineFeature.Closed : asClosed"}}},
        {"id": "t.feature_activitystatusmachinefeature.0005", "from": "feature.ActivityStatusMachineFeature.Init", "to": "feature.ActivityStatusMachineFeature.Archived", "event": "asArchived", "roles": ["admin"], "narrative": {"summary": "顯示 archived 狀態", "taskDescription": "在 Init 觸發 asArchived 進入 Archived。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0005.01", "type": "semantic-check", "description": "目前活動 status 為 archived；對外完全不可見；不可報名與取消", "expected": null}], "intent": {"category": "action", "summary": "asArchived"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Init --> ActivityStatusMachineFeature.Archived : asArchived"}}},
        {"id": "t.feature_activitystatusmachinefeature.0006", "from": "feature.ActivityStatusMachineFeature.Draft", "to": "feature.ActivityStatusMachineFeature.Published", "event": "publish", "roles": ["admin"], "narrative": {"summary": "發布活動", "taskDescription": "在 Draft 觸發 publish 進入 Published。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0006.01", "type": "semantic-check", "description": "API 驗證 Admin；驗證 date > deadline、capacity 正整數；成功後 status=published 且 AuditLog 記錄狀態變更", "expected": null}], "intent": {"category": "action", "summary": "publish"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Draft --> ActivityStatusMachineFeature.Published : publish"}}},
        {"id": "t.feature_activitystatusmachinefeature.0007", "from": "feature.ActivityStatusMachineFeature.Draft", "to": "feature.ActivityStatusMachineFeature.Archived", "event": "archive", "roles": ["admin"], "narrative": {"summary": "封存活動", "taskDescription": "在 Draft 觸發 archive 進入 Archived。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0007.01", "type": "semantic-check", "description": "API 驗證 Admin；成功後 status=archived 並記錄 AuditLog；公開列表不再顯示該活動", "expected": null}], "intent": {"category": "action", "summary": "archive"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Draft --> ActivityStatusMachineFeature.Archived : archive"}}},
        {"id": "t.feature_activitystatusmachinefeature.0008", "from": "feature.ActivityStatusMachineFeature.Published", "to": "feature.ActivityStatusMachineFeature.Closed", "event": "close", "roles": ["admin"], "narrative": {"summary": "關閉活動", "taskDescription": "在 Published 觸發 close 進入 Closed。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0008.01", "type": "semantic-check", "description": "API 驗證 Admin；成功後 status=closed 且不可報名；需記錄 AuditLog", "expected": null}], "intent": {"category": "action", "summary": "close"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Published --> ActivityStatusMachineFeature.Closed : close"}}},
        {"id": "t.feature_activitystatusmachinefeature.0009", "from": "feature.ActivityStatusMachineFeature.Published", "to": "feature.ActivityStatusMachineFeature.Full", "event": "autoFull", "roles": ["admin"], "narrative": {"summary": "自動額滿", "taskDescription": "在 Published 觸發 autoFull 進入 Full。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0009.01", "type": "semantic-check", "description": "當 registered_count 達 capacity 時系統自動切換 status=full；不得出現 registered_count > capacity（避免超賣）", "expected": null}], "intent": {"category": "action", "summary": "autoFull"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Published --> ActivityStatusMachineFeature.Full : autoFull"}}},
        {"id": "t.feature_activitystatusmachinefeature.0010", "from": "feature.ActivityStatusMachineFeature.Full", "to": "feature.ActivityStatusMachineFeature.Closed", "event": "close", "roles": ["admin"], "narrative": {"summary": "關閉活動", "taskDescription": "在 Full 觸發 close 進入 Closed。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0010.01", "type": "semantic-check", "description": "API 驗證 Admin；成功後 status=closed；需記錄 AuditLog", "expected": null}], "intent": {"category": "action", "summary": "close"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Full --> ActivityStatusMachineFeature.Closed : close"}}},
        {"id": "t.feature_activitystatusmachinefeature.0011", "from": "feature.ActivityStatusMachineFeature.Full", "to": "feature.ActivityStatusMachineFeature.Published", "event": "autoReopenOnCapacity", "roles": ["admin"], "narrative": {"summary": "釋放名額自動重開", "taskDescription": "在 Full 觸發 autoReopenOnCapacity 進入 Published。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0011.01", "type": "semantic-check", "description": "取消報名造成 registered_count < capacity 且仍未過 deadline 且未被手動關閉時，系統可切回 published；UI 顯示可報名", "expected": null}], "intent": {"category": "action", "summary": "autoReopenOnCapacity"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Full --> ActivityStatusMachineFeature.Published : autoReopenOnCapacity"}}},
        {"id": "t.feature_activitystatusmachinefeature.0012", "from": "feature.ActivityStatusMachineFeature.Closed", "to": "feature.ActivityStatusMachineFeature.Archived", "event": "archive", "roles": ["admin"], "narrative": {"summary": "封存活動", "taskDescription": "在 Closed 觸發 archive 進入 Archived。"}, "validations": [{"id": "v.t.feature_activitystatusmachinefeature.0012.01", "type": "semantic-check", "description": "API 驗證 Admin；成功後 status=archived；需記錄 AuditLog", "expected": null}], "intent": {"category": "action", "summary": "archive"}, "meta": {"diagramId": "feature_activitystatusmachinefeature", "source": {"raw": "ActivityStatusMachineFeature.Closed --> ActivityStatusMachineFeature.Archived : archive"}}}
      ],
      "connectors": [
        {"id": "c.page_entry.contains.feature_activitystatusmachinefeature", "type": "contains", "from": {"diagramId": "page_entry", "stateId": null}, "to": {"diagramId": "feature_activitystatusmachinefeature", "stateId": null}, "narrative": {"summary": "Entry 包含 ActivityStatusMachineFeature", "taskDescription": "建立 parent/child 關聯，表示 ActivityStatusMachineFeature 隸屬於 Entry。"}, "validations": [], "meta": {"reason": "derived from parentDiagramId"}},
        {"id": "c.page_adminactivitylistpage.invokes.feature_activitystatusmachinefeature.s.page_AdminActivityListPage_Ready.to.feature_ActivityStatusMachineFeature_Init", "type": "invokes", "from": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Ready"}, "to": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Init"}, "narrative": {"summary": "從列表開啟狀態變更", "taskDescription": "在 Ready 觸發 openStatusChange 進入 ActivityStatusMachineFeature.Init。"}, "validations": [], "meta": {"reason": "openStatusChange | navigate ActivityStatusMachineFeature", "action": "openStatusChange", "navigateTarget": "ActivityStatusMachineFeature"}},
        {"id": "c.page_adminactivityeditorpage.invokes.feature_activitystatusmachinefeature.s.page_AdminActivityEditorPage_Editing.to.feature_ActivityStatusMachineFeature_Init", "type": "invokes", "from": {"diagramId": "page_adminactivityeditorpage", "stateId": "page.AdminActivityEditorPage.Editing"}, "to": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Init"}, "narrative": {"summary": "從編輯頁開啟狀態變更", "taskDescription": "在 Editing 觸發 clickPublishCloseArchive 進入 ActivityStatusMachineFeature.Init。"}, "validations": [], "meta": {"reason": "clickPublishCloseArchive | navigate ActivityStatusMachineFeature", "action": "clickPublishCloseArchive", "navigateTarget": "ActivityStatusMachineFeature"}},
        {"id": "c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.s.feature_ActivityStatusMachineFeature_Published.to.page_AdminActivityListPage_Init", "type": "invokes", "from": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Published"}, "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"}, "narrative": {"summary": "狀態變更返回列表（published）", "taskDescription": "在 Published 觸發 statusChangedReturn 導航到 /admin/activities，並回到 AdminActivityListPage.Init。"}, "validations": [{"id": "v.c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.01", "type": "semantic-check", "description": "UI 回到管理活動列表並顯示最新 status/registered_count；變更行為被 AuditLog 記錄", "expected": null}], "meta": {"reason": "statusChangedReturn | navigate /admin/activities", "action": "statusChangedReturn", "navigateTarget": "/admin/activities"}},
        {"id": "c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.s.feature_ActivityStatusMachineFeature_Full.to.page_AdminActivityListPage_Init", "type": "invokes", "from": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Full"}, "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"}, "narrative": {"summary": "狀態變更返回列表（full）", "taskDescription": "在 Full 觸發 statusChangedReturn 導航到 /admin/activities，並回到 AdminActivityListPage.Init。"}, "validations": [{"id": "v.c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.02", "type": "semantic-check", "description": "UI 回到列表並顯示 full；公開列表仍可見但不可報名；registered_count 與 capacity 一致", "expected": null}], "meta": {"reason": "statusChangedReturn | navigate /admin/activities", "action": "statusChangedReturn", "navigateTarget": "/admin/activities"}},
        {"id": "c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.s.feature_ActivityStatusMachineFeature_Closed.to.page_AdminActivityListPage_Init", "type": "invokes", "from": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Closed"}, "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"}, "narrative": {"summary": "狀態變更返回列表（closed）", "taskDescription": "在 Closed 觸發 statusChangedReturn 導航到 /admin/activities，並回到 AdminActivityListPage.Init。"}, "validations": [{"id": "v.c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.03", "type": "semantic-check", "description": "UI 回到列表並顯示 closed；公開列表/詳情不再可見該活動（對 Guest/Member 視為不可見）", "expected": null}], "meta": {"reason": "statusChangedReturn | navigate /admin/activities", "action": "statusChangedReturn", "navigateTarget": "/admin/activities"}},
        {"id": "c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.s.feature_ActivityStatusMachineFeature_Archived.to.page_AdminActivityListPage_Init", "type": "invokes", "from": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Archived"}, "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"}, "narrative": {"summary": "狀態變更返回列表（archived）", "taskDescription": "在 Archived 觸發 statusChangedReturn 導航到 /admin/activities，並回到 AdminActivityListPage.Init。"}, "validations": [{"id": "v.c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.04", "type": "semantic-check", "description": "UI 回到列表並顯示 archived；公開列表/詳情不再可見；不可再進行狀態操作（或僅顯示不可變更）", "expected": null}], "meta": {"reason": "statusChangedReturn | navigate /admin/activities", "action": "statusChangedReturn", "navigateTarget": "/admin/activities"}},
        {"id": "c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.s.feature_ActivityStatusMachineFeature_Draft.to.page_AdminActivityListPage_Init", "type": "invokes", "from": {"diagramId": "feature_activitystatusmachinefeature", "stateId": "feature.ActivityStatusMachineFeature.Draft"}, "to": {"diagramId": "page_adminactivitylistpage", "stateId": "page.AdminActivityListPage.Init"}, "narrative": {"summary": "狀態變更返回列表（draft）", "taskDescription": "在 Draft 觸發 statusChangedReturn 導航到 /admin/activities，並回到 AdminActivityListPage.Init。"}, "validations": [{"id": "v.c.feature_activitystatusmachinefeature.invokes.page_adminactivitylistpage.05", "type": "semantic-check", "description": "UI 回到列表並顯示 draft；僅 Admin 可見；對外不可見", "expected": null}], "meta": {"reason": "statusChangedReturn | navigate /admin/activities", "action": "statusChangedReturn", "navigateTarget": "/admin/activities"}}
      ],
      "meta": {
        "pageName": null,
        "featureName": "ActivityStatusMachineFeature",
        "entryStateId": "feature.ActivityStatusMachineFeature.Init",
        "entryValidations": [
          {"id": "v.feature_activitystatusmachinefeature.entry.01", "type": "semantic-check", "description": "僅 Admin 可進入狀態變更；UI 顯示可操作的狀態轉移選項（依目前 status）", "expected": null}
        ]
      }
    }
  ],
  "hierarchy": {
    "roots": ["page_entry"],
    "childrenByDiagramId": {
      "page_entry": [
        "page_activitylistpage",
        "page_activitydetailpage",
        "page_authpage",
        "page_myactivitiespage",
        "page_adminactivitylistpage",
        "page_adminactivityeditorpage",
        "page_adminregistrationspage",
        "feature_authloginfeature",
        "feature_authregisterfeature",
        "feature_logoutfeature",
        "feature_registeractivityfeature",
        "feature_cancelregistrationfeature",
        "feature_adminupsertactivityfeature",
        "feature_adminexportregistrationscsvfeature",
        "feature_activitystatusmachinefeature"
      ],
      "page_activitylistpage": [
        "page_activitylistpage_guest",
        "page_activitylistpage_member",
        "page_activitylistpage_admin"
      ],
      "page_activitydetailpage": [
        "page_activitydetailpage_guest",
        "page_activitydetailpage_member",
        "page_activitydetailpage_admin"
      ]
    }
  },
  "meta": {
    "warnings": []
  }
}